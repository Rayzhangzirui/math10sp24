
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>[Predicting CO2 Emissions of Vehicles] &#8212; UCI Math 10, Spring 2024</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'final_project_demo/zhaomickey';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Math 10 Final Project: Analyzing the weather conditions in 10 locations" href="zhangzidong.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">UCI Math 10, Spring 2024</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    UC Irvine, Math 10, Fall 2023
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../syllabus.html">Course Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../final_project_instruction.html">Final Project Instruction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../final_project_template.html">[Title here]</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../notes/notes_intro.html">Notes</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notes/python_review.html">Python review</a></li>

<li class="toctree-l2"><a class="reference internal" href="../notes/OOP.html">OOP and Gradient Descent</a></li>


<li class="toctree-l2"><a class="reference internal" href="../notes/prob_stat.html">Probability and Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/pandas.html">Pandas dataframe</a></li>





<li class="toctree-l2"><a class="reference internal" href="../notes/visualization.html">Visualization</a></li>


<li class="toctree-l2"><a class="reference internal" href="../notes/linear_regression.html">Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/multi_linear_reg.html">Multiple Linear Regression</a></li>

<li class="toctree-l2"><a class="reference internal" href="../notes/trade_off.html">Bias-Variance Tradeoff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/cv.html">Cross Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/feature_scaling.html">Feature Scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/regularization.html">Regularization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/logistic_binary.html">Binary Classification with logistic regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/logistic_multiclass.html">Logistic Regression for Multiclass Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/knn.html">Nearest Neighbor Regression and Classification</a></li>

<li class="toctree-l2"><a class="reference internal" href="../notes/pca.html">Dimensionality Reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/kmeans.html">Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/intro_nn.html">Nerual Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/gan.html">Generative Adversarial Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/fairness.html">Bias and Fairness</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lectures/intro.html">Lectures</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week1_Mon.html">week1 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week1_Wed.html">week1 Wed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week1_Fri.html">week1 Fri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week2_Mon.html">week2 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week2_Wed.html">week2 Wed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week2_Fri.html">week2 Fri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week3_Mon.html">week3 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week3_Wed.html">week3 Wed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week3_Fri.html">week3 Fri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week4_Mon.html">week4 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week4_Wed.html">week4 Wed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week4_Fri.html">week4 Fri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week5_Mon.html">week5 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week5_Wed.html">week4 Wed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week6_Mon.html">week6 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week6_Wed.html">week6 Wed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week6_Fri.html">week6 Fri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week7_Mon.html">week7 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week7_Wed.html">week7 Wed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week7_Fri.html">week7 Fri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week8_Mon.html">week8 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week8_Wed.html">week8 Wed</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../homework/intro.html">Homework</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../homework/worksheet_mpg.html">worksheet week 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/worksheet_mpg_sol.html">worksheet week 3 Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/homework1_sol.html">Homework 1 (Due 4/12)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/homework2_sol.html">Homework 2 (Due 4/19)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/homework3_sol.html">Homework 3 (Due 4/26)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/homework4_sol.html">Homework 4 (Due 5/10)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/homework5_sol.html">Homework 5 (Due 5/17)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/homework6_sol.html">Homework 6 (Due 5/24)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/homework7_sol.html">Homework 7 (Due 5/31)</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">Student Projects</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="baosi.html">Predicting NBA Game Outcomes Project</a></li>










<li class="toctree-l2"><a class="reference internal" href="caotranhoangthuc.html">Cancer Prediction Based on Medical and Lifestyle Information</a></li>









<li class="toctree-l2"><a class="reference internal" href="changsilas.html">An Analysis of USA Climbing’s Youth Bouldering Series.</a></li>






<li class="toctree-l2"><a class="reference internal" href="chenyu.html">Predicting computer prices using multiple linear regression and decision trees</a></li>








<li class="toctree-l2"><a class="reference internal" href="dabirarjun.html">Analyzing Tennis Match Outcomes in the 2014 Grand Slams</a></li>
<li class="toctree-l2"><a class="reference internal" href="huanganita.html">Youtube Video Trending Prediction</a></li>




<li class="toctree-l2"><a class="reference internal" href="huynhstanley.html">Wine Quality Analysis</a></li>

<li class="toctree-l2"><a class="reference internal" href="jiaoyuhao.html">Analysis of house price forecasts and influencing factors</a></li>




<li class="toctree-l2"><a class="reference internal" href="kimmalex.html">Sleep, Exercise, and UCI Life’s Effect on a College Student’s Health</a></li>
<li class="toctree-l2"><a class="reference internal" href="milleradamchristopher.html">Classifying Songs by Genre using its Features</a></li>





<li class="toctree-l2"><a class="reference internal" href="mongiadron.html">US GDP Forecasting</a></li>













<li class="toctree-l2"><a class="reference internal" href="nguyenalexanderdavid.html">MOVIE SUCCESS IN RELATION TO ITS FILM DISTRIBUTION COMPANY</a></li>







<li class="toctree-l2"><a class="reference internal" href="nguyenmilanngoc.html">LPGA 2022 Rolex Ranking</a></li>
<li class="toctree-l2"><a class="reference internal" href="presnyakovoleg.html">Phone cost prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="roblesisabellaesther.html">Predicting Medical Expenses for Insurance and Analyzing Factors</a></li>





<li class="toctree-l2"><a class="reference internal" href="sonnevillenicolecaroline.html">Predicting ratings on Sephora based on price and number of ingredients</a></li>
<li class="toctree-l2"><a class="reference internal" href="tongbenjaminv.html">Prediction and Classification of Stellar Characteristics</a></li>
<li class="toctree-l2"><a class="reference internal" href="torreshornbeakelijahcharles.html">Methods for Analyzing the Best NBA Players</a></li>

<li class="toctree-l2"><a class="reference internal" href="trancrystal.html">Analysis of Mushroom Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="tranethank.html">Top Valorant Players</a></li>

















<li class="toctree-l2"><a class="reference internal" href="wunathan.html">Image Classfication on “Heart Failure Cinical Records” Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="yangchenxi.html">Analysis of Tesla Stock Price in the most recnet 6 months</a></li>
<li class="toctree-l2"><a class="reference internal" href="zhangzhiwei.html">CO2 Emissions and Renewable Energy Trends</a></li>








<li class="toctree-l2"><a class="reference internal" href="zhangzidong.html">Math 10 Final Project: Analyzing the weather conditions in 10 locations</a></li>




<li class="toctree-l2 current active"><a class="current reference internal" href="#">[Predicting CO2 Emissions of Vehicles]</a></li>








</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/final_project_demo/zhaomickey.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>[Predicting CO2 Emissions of Vehicles]</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">[Predicting CO2 Emissions of Vehicles]</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-exploration">Data Exploration</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preprocessing">Data Preprocessing</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-selection">Feature Selection</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#model-building">Model Building</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#model-improvement">Model Improvement</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="predicting-co2-emissions-of-vehicles">
<h1>[Predicting CO2 Emissions of Vehicles]<a class="headerlink" href="#predicting-co2-emissions-of-vehicles" title="Link to this heading">#</a></h1>
<p>Author: [Mickey Zhao]</p>
<p>Course Project, UC Irvine, Math 10, S24</p>
<p>I would like to post my notebook on the course’s website. [Yes]</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h1>
<p>The dataset I am using is</p>
<p>itertools</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-exploration">
<h1>Data Exploration<a class="headerlink" href="#data-exploration" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="c1">#load the dataset</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;CO2 Emissions.csv&#39;</span><span class="p">)</span>

<span class="c1">#deleting the rows that have any amount of empty variables</span>
<span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">)</span>

<span class="c1"># #print the first few rows of dataset to get a sense of the data</span>
<span class="c1"># print(df.head())</span>

<span class="c1"># #get a summary of the columns of numerical data</span>
<span class="c1"># print(df.describe())</span>

<span class="c1"># #get information about the dataset</span>
<span class="c1"># print(df.info())</span>

<span class="c1"># #plot histograms for the numerical data</span>
<span class="c1"># df.hist(figsize=(15,10))</span>

<span class="c1"># #plot the categorical datas into countplot</span>
<span class="c1"># for column in df.select_dtypes(include=[&#39;object&#39;]).columns:</span>
<span class="c1">#     plt.figure(figsize=(10, 5))</span>
<span class="c1">#     sns.countplot(data=df, x=column)</span>
<span class="c1">#     plt.title(column)</span>
<span class="c1">#     plt.xticks(rotation=90)</span>
<span class="c1">#     plt.show()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-preprocessing">
<h1>Data Preprocessing<a class="headerlink" href="#data-preprocessing" title="Link to this heading">#</a></h1>
<p>After taking a brief look at the data, I noticed that some of the information does not provide much help. Therefore, I am dropping the Make, Model, Vehicle class, as well as Transmission. These data are not directly related to CO2 emission. I will also be deleting the Fuel Consumption Comb (mpg), as it is simply the same as Fuel Consumption Comb (L/100km) but in a different unit. Therefore, I will delete these two columns from the dataset.</p>
<p>Then, I will rename some of the columns as some of the names are too long and not useful for displaying. I have changed Fuel Consumption City to Fuel City, Fuel Consumption Hwy to Fuel Hwy, and Fuel Consumption Comb to Fuel Comb</p>
<p>I will also be renaming the letters under Fuel Type to the actual fuel type they represent, so it is easier to understand.</p>
<p>Lastly, I will scale the numerical columns with standardization to make sure they are all on the same scale so they are compariable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>


<span class="c1">#drop the (Model) and (Fuel Consumption Comb mpg) columns of data from the dataset</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Make&#39;</span><span class="p">,</span><span class="s1">&#39;Model&#39;</span><span class="p">,</span><span class="s1">&#39;Vehicle Class&#39;</span><span class="p">,</span> <span class="s1">&#39;Transmission&#39;</span><span class="p">,</span> <span class="s1">&#39;Fuel Consumption Comb (mpg)&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#Rename some of the columns for earier readability</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Fuel Consumption City (L/100 km)&#39;</span><span class="p">:</span><span class="s1">&#39;Fuel City&#39;</span><span class="p">,</span> <span class="s1">&#39;Fuel Consumption Hwy (L/100 km)&#39;</span><span class="p">:</span><span class="s1">&#39;Fuel Hwy&#39;</span><span class="p">,</span> <span class="s1">&#39;Fuel Consumption Comb (L/100 km)&#39;</span><span class="p">:</span><span class="s1">&#39;Fuel Comb&#39;</span><span class="p">})</span>

<span class="c1">#renaming values under Fuel Type</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Fuel Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Fuel Type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Regular Gas&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Fuel Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Fuel Type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;Premium Gas&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Fuel Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Fuel Type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;Diesel&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Fuel Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Fuel Type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;Ethanol&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Fuel Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Fuel Type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;Natural Gas&#39;</span><span class="p">)</span>


<span class="c1">#scale the numerical columns with standardization</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">numerical</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
<span class="n">df</span><span class="p">[</span><span class="n">numerical</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">numerical</span><span class="p">])</span>

<span class="c1">#Visualizing the processed dataset</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1">#get a summary of the columns of numerical data</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="c1">#get information about the dataset</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>

<span class="c1">#plot histograms for the numerical data</span>
<span class="n">df</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="c1">#plot the categorical datas into countplot</span>
<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">column</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Engine Size(L)  Cylinders    Fuel Type  Fuel City  Fuel Hwy  Fuel Comb  \
0       -0.856721  -0.883408  Premium Gas  -0.759002 -1.052781  -0.855742   
1       -0.561317  -0.883408  Premium Gas  -0.387577 -0.603202  -0.475423   
2       -1.225976  -0.883408  Premium Gas  -1.873275 -1.457401  -1.754677   
3        0.251043   0.210575  Premium Gas   0.040990  0.026208   0.043193   
4        0.251043   0.210575  Premium Gas  -0.130437 -0.153624  -0.129679   

   CO2 Emissions(g/km)  
0            -0.932933  
1            -0.505646  
2            -1.958421  
3             0.075464  
4            -0.112542  
       Engine Size(L)    Cylinders     Fuel City      Fuel Hwy     Fuel Comb  \
count    7.385000e+03  7385.000000  7.385000e+03  7.385000e+03  7.385000e+03   
mean     2.963401e-16     0.000000  2.232172e-16 -9.621432e-18  1.539429e-17   
std      1.000068e+00     1.000068  1.000068e+00  1.000068e+00  1.000068e+00   
min     -1.669081e+00    -1.430399 -2.387556e+00 -2.266643e+00 -2.377017e+00   
25%     -8.567210e-01    -0.883408 -7.018593e-01 -6.931179e-01 -7.174441e-01   
50%     -1.182115e-01     0.210575 -1.304368e-01 -1.536237e-01 -1.296787e-01   
75%      3.987451e-01     0.210575  5.838414e-01  5.207440e-01  5.618100e-01   
max      3.869740e+00     5.680488  5.155222e+00  5.196360e+00  5.229359e+00   

       CO2 Emissions(g/km)  
count         7.385000e+03  
mean         -1.298893e-16  
std           1.000068e+00  
min          -2.642080e+00  
25%          -7.278351e-01  
50%          -7.835924e-02  
75%           6.394825e-01  
max           4.638887e+00  
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 7385 entries, 0 to 7384
Data columns (total 7 columns):
 #   Column               Non-Null Count  Dtype  
---  ------               --------------  -----  
 0   Engine Size(L)       7385 non-null   float64
 1   Cylinders            7385 non-null   float64
 2   Fuel Type            7385 non-null   object 
 3   Fuel City            7385 non-null   float64
 4   Fuel Hwy             7385 non-null   float64
 5   Fuel Comb            7385 non-null   float64
 6   CO2 Emissions(g/km)  7385 non-null   float64
dtypes: float64(6), object(1)
memory usage: 404.0+ KB
None
</pre></div>
</div>
<img alt="../_images/c81d8e8292dda1a186ff70b6bc2687d0cd94f8456699b9294c1ad2c8ed27426b.png" src="../_images/c81d8e8292dda1a186ff70b6bc2687d0cd94f8456699b9294c1ad2c8ed27426b.png" />
<img alt="../_images/468b13b22f65db2bae76fc3bd14129e0159b7e9740f16117109dd76311260ce2.png" src="../_images/468b13b22f65db2bae76fc3bd14129e0159b7e9740f16117109dd76311260ce2.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="feature-selection">
<h1>Feature Selection<a class="headerlink" href="#feature-selection" title="Link to this heading">#</a></h1>
<p>Here I want to see which feature/collection of features are the most correlated with CO2 emission. I first created dummy variables to make use of the categorical data of Fuel type, then went on to compute the R^2 value and determine which features to use later on.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span>

<span class="c1"># Create dummy variables for Premium Gas and Regular Gas</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;isPremiumGas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Fuel Type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Premium Gas&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;isRegularGas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Fuel Type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Regular Gas&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1">#drop the original fueltype column</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Fuel Type&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">r2_values</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1">#compte the R^2 Value for each feature</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">col</span> <span class="o">!=</span> <span class="s1">&#39;CO2 Emissions(g/km)&#39;</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="n">col</span><span class="p">]],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;CO2 Emissions(g/km)&#39;</span><span class="p">])</span>
        <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="n">col</span><span class="p">]])</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CO2 Emissions(g/km)&#39;</span><span class="p">],</span> <span class="n">pred</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R^2 value for </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">r2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">r2_values</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">r2</span><span class="p">,</span> <span class="p">[</span><span class="n">column</span><span class="p">]))</span>

<span class="c1">#compute the R^2 values for all combinations of features.</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">subset</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;CO2 Emissions(g/km)&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">subset</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">subset</span><span class="p">)],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;CO2 Emissions(g/km)&#39;</span><span class="p">])</span>
            <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">subset</span><span class="p">)])</span>
            <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CO2 Emissions(g/km)&#39;</span><span class="p">],</span> <span class="n">pred</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R^2 value for </span><span class="si">{</span><span class="n">subset</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">r2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">r2_values</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">r2</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">subset</span><span class="p">)))</span>
    
<span class="c1">#find and print the highest R^2 value and its feature/features</span>
<span class="n">maxr2</span><span class="p">,</span> <span class="n">features</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">r2_values</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The highest R^2 value is </span><span class="si">{</span><span class="n">maxr2</span><span class="si">}</span><span class="s2"> with the features </span><span class="si">{</span><span class="n">features</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>R^2 value for Engine Size(L): 0.724447204652408
R^2 value for Cylinders: 0.6932953649936135
R^2 value for Fuel City: 0.8456503198972762
R^2 value for Fuel Hwy: 0.7806357669286315
R^2 value for Fuel Comb: 0.8428186895623989
R^2 value for isPremiumGas: 0.053436609700923454
R^2 value for isRegularGas: 0.06779898089491276
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;): 0.7377528816900287
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel City&#39;): 0.8699441320331145
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel Hwy&#39;): 0.8563219686877784
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel Comb&#39;): 0.8735316040065462
R^2 value for (&#39;Engine Size(L)&#39;, &#39;isPremiumGas&#39;): 0.729900934577502
R^2 value for (&#39;Engine Size(L)&#39;, &#39;isRegularGas&#39;): 0.7281953871094475
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel City&#39;): 0.8715042331508964
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel Hwy&#39;): 0.8631018084716602
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel Comb&#39;): 0.8772970198353781
R^2 value for (&#39;Cylinders&#39;, &#39;isPremiumGas&#39;): 0.6932953771687405
R^2 value for (&#39;Cylinders&#39;, &#39;isRegularGas&#39;): 0.6932996310500763
R^2 value for (&#39;Fuel City&#39;, &#39;Fuel Hwy&#39;): 0.846982446929685
R^2 value for (&#39;Fuel City&#39;, &#39;Fuel Comb&#39;): 0.8470468551357692
R^2 value for (&#39;Fuel City&#39;, &#39;isPremiumGas&#39;): 0.8528603299245059
R^2 value for (&#39;Fuel City&#39;, &#39;isRegularGas&#39;): 0.8470737167425708
R^2 value for (&#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;): 0.8469847069125569
R^2 value for (&#39;Fuel Hwy&#39;, &#39;isPremiumGas&#39;): 0.8054343170609857
R^2 value for (&#39;Fuel Hwy&#39;, &#39;isRegularGas&#39;): 0.7817787661499447
R^2 value for (&#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;): 0.8544455876749126
R^2 value for (&#39;Fuel Comb&#39;, &#39;isRegularGas&#39;): 0.8431776555503093
R^2 value for (&#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.0679761080716087
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel City&#39;): 0.8737643405109318
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel Hwy&#39;): 0.8667637416148511
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel Comb&#39;): 0.8791960197256039
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;isPremiumGas&#39;): 0.7395785549060869
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;isRegularGas&#39;): 0.738857621343777
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;): 0.8736448548511682
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel City&#39;, &#39;Fuel Comb&#39;): 0.8736903490010458
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel City&#39;, &#39;isPremiumGas&#39;): 0.8748643122988111
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel City&#39;, &#39;isRegularGas&#39;): 0.8707504505657375
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;): 0.8736767251503087
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel Hwy&#39;, &#39;isPremiumGas&#39;): 0.8678350725377149
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel Hwy&#39;, &#39;isRegularGas&#39;): 0.8565901962042605
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;): 0.8808176752573282
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel Comb&#39;, &#39;isRegularGas&#39;): 0.8737623719730641
R^2 value for (&#39;Engine Size(L)&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.7299166007190443
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;): 0.8772312553083228
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Comb&#39;): 0.8773008147640721
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;isPremiumGas&#39;): 0.8736040897455617
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;isRegularGas&#39;): 0.8742974174661806
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;): 0.8773022759209378
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel Hwy&#39;, &#39;isPremiumGas&#39;): 0.8681994103978634
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel Hwy&#39;, &#39;isRegularGas&#39;): 0.863507293889194
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;): 0.8807338479537475
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel Comb&#39;, &#39;isRegularGas&#39;): 0.8790797712554232
R^2 value for (&#39;Cylinders&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.6933093351090776
R^2 value for (&#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;): 0.8470636880567088
R^2 value for (&#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;isPremiumGas&#39;): 0.8560203614811307
R^2 value for (&#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;isRegularGas&#39;): 0.8480298136093141
R^2 value for (&#39;Fuel City&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;): 0.8561292201160875
R^2 value for (&#39;Fuel City&#39;, &#39;Fuel Comb&#39;, &#39;isRegularGas&#39;): 0.8480837289918454
R^2 value for (&#39;Fuel City&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.9028125048408877
R^2 value for (&#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;): 0.856111821340658
R^2 value for (&#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isRegularGas&#39;): 0.8480023875689473
R^2 value for (&#39;Fuel Hwy&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.8504602449865788
R^2 value for (&#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.9064485352236359
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;): 0.8791497160089631
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Comb&#39;): 0.879204822550623
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;isPremiumGas&#39;): 0.8767586046387236
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;isRegularGas&#39;): 0.8756641409254421
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;): 0.8792074892569878
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel Hwy&#39;, &#39;isPremiumGas&#39;): 0.8733510394975257
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel Hwy&#39;, &#39;isRegularGas&#39;): 0.8668523292231199
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;): 0.8836028164141739
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel Comb&#39;, &#39;isRegularGas&#39;): 0.8803527153748766
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.7396084687939061
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;): 0.8736921162216665
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;isPremiumGas&#39;): 0.880771250310037
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;isRegularGas&#39;): 0.8739814887257374
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel City&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;): 0.8808420038219624
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel City&#39;, &#39;Fuel Comb&#39;, &#39;isRegularGas&#39;): 0.874023675551616
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel City&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.9104010275082156
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;): 0.8808450833543107
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isRegularGas&#39;): 0.8740039755923887
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel Hwy&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.8943541756831168
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.9170284171823359
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;): 0.8773041647111276
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;isPremiumGas&#39;): 0.8807580422924677
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;isRegularGas&#39;): 0.8790455384681733
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;): 0.880849938190063
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Comb&#39;, &#39;isRegularGas&#39;): 0.8791043058137383
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.9106693771064098
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;): 0.8808536786912412
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isRegularGas&#39;): 0.8790997834617473
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel Hwy&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.8966817319361021
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.9183467865473713
R^2 value for (&#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;): 0.8561393791542129
R^2 value for (&#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isRegularGas&#39;): 0.8481020003085535
R^2 value for (&#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.9077022420580547
R^2 value for (&#39;Fuel City&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.9078299554859206
R^2 value for (&#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.907800020142427
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;): 0.8792100801886359
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;isPremiumGas&#39;): 0.8837069069105592
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;isRegularGas&#39;): 0.8803115482940639
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;): 0.8837814396463615
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Comb&#39;, &#39;isRegularGas&#39;): 0.8803609458269425
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.9115190240331004
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;): 0.8837879473075011
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isRegularGas&#39;): 0.8803582316894153
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel Hwy&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.8996028233723614
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.9190733256503609
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;): 0.880845827187235
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isRegularGas&#39;): 0.8740250663192007
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.9169925493173977
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel City&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.9170895348975028
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.917082706749653
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;): 0.8808538296457733
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isRegularGas&#39;): 0.8791071567936254
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.9182406595353432
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.9183514563051901
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.9183499998887739
R^2 value for (&#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.9078333663133284
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;): 0.8837880763382117
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isRegularGas&#39;): 0.8803653505525849
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.918972405287451
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.91907368402523
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.9190733652137857
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.9170911451532392
R^2 value for (&#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.9183536328647169
R^2 value for (&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;): 0.9190768806205052

The highest R^2 value is 0.9190768806205052 with the features [&#39;Engine Size(L)&#39;, &#39;Cylinders&#39;, &#39;Fuel City&#39;, &#39;Fuel Hwy&#39;, &#39;Fuel Comb&#39;, &#39;isPremiumGas&#39;, &#39;isRegularGas&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="model-building">
<h1>Model Building<a class="headerlink" href="#model-building" title="Link to this heading">#</a></h1>
<p>After the previous part, we can see that by using all 7 features gives us the highest R^2 value. Which means we should use all 7 features to build our model.</p>
<p>I am splitting the data into a simple training and testing set, with the size of the testing set = 20% of the total data. I am not using the k-fold method because the data contains 7385 rows and I think using a simple train-test split is sufficient. However, if we want to ensure the model’s performance really is not dependent on the way the data is split, we could simply implement a k-fold cross validation like what we did in the homework. (I set the random_state=5 for reproducibility but I ran a lot of tests with it being completely random and found out that the MSE and R^2 values did not vary a lot, which is why I think using a simple train test split is sufficient)</p>
<p>I am using a Linear Regression model and computing the Mean Squared Error as well as R^2 score by comparing the predictions to the actual value of CO2 emissions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;CO2 Emissions(g/km)&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;CO2 Emissions(g/km)&#39;</span><span class="p">]</span>

<span class="c1">#split the data into training and testing sets (setting a random_state so we can reproduce the results, for an accurate model we would set it to completely random)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>

<span class="c1">#train the model</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1">#using the testing data to predict</span>
<span class="n">ypred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1">#calculate Mean squared error</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">ypred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean Squared Error:&quot;</span><span class="p">,</span> <span class="n">mse</span><span class="p">)</span>

<span class="c1">#calculated R^2 score</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">ypred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;R^2 Score:&quot;</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean Squared Error: 0.0809956732770324
R^2 Score: 0.9163641899489641
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="model-improvement">
<h1>Model Improvement<a class="headerlink" href="#model-improvement" title="Link to this heading">#</a></h1>
<p>From the previous part, we can see that the Linear Regression model has a MSE of 0.080996 and a R^2 value of 0.916264. MSE is a measure of the average squared difference between the model’s predictions and the actual values, with a lower value indicating a better model performance. The R^2 value is a measure of how well the model’s predictions fit the actual values, with a higher value (values closer to 1) indicating a better model performance. The MSE value is quite low and the R^2 value is quite high, suggesting that the model is performing well at predicting CO2 emissions based on the features (Engine Size, Cylinders, Fuel City, Fuel Hwy, Fuel Comb, IsPremiumGas, isRegularGas)</p>
<p>To improve the model, I am trying to use Ridge and Lasso regression models and cross validation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Lasso</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">ridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">()</span>
<span class="n">lasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">()</span>

<span class="c1"># ridge regression</span>
<span class="n">ridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">ridge</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ridge Regression Cross-Validated R^2 Scores:&quot;</span><span class="p">,</span> <span class="n">scores</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean R^2:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">))</span>

<span class="c1">#Lasso regression</span>
<span class="n">lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">lasso</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Lasso Regression Cross-Validated R^2 Scores:&quot;</span><span class="p">,</span> <span class="n">scores</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean R^2:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ridge Regression Cross-Validated R^2 Scores: [0.88948323 0.91617298 0.93654668 0.90131837 0.9283508 ]
Mean R^2: 0.9143744133744344
Lasso Regression Cross-Validated R^2 Scores: [-0.01256932 -0.00734865 -0.00390721 -0.00532579 -0.00173666]
Mean R^2: -0.006177525224785807
</pre></div>
</div>
</div>
</div>
<p>Looking at the results, the R^2 score for Ridge regression is quite high, indicating that it is a good fit.</p>
<p>On the other hand, we got a negative value for the r^2 value of Lasso regression. A negative R^2 score is possible to produce, because the model is split separately into training and testing data. It indicates that our model had a very poor fit.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="conclusion">
<h1>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h1>
<p>Looking at our results, it seems that both Linear Regression and Ridge Regression are a good fit for our model, as indicated by the high R^2 values. It suggest that both these models are capable of predicting the CO2 emissions based on the features (Engine Size, Cylinders, Fuel City, Fuel Hwy, Fuel Comb, IsPremiumGas, isRegularGas)</p>
<p>However, the bias-variance tradeoff shouldn’t be overlooked. The bias-variance tradeoff is a fundamental concept in machine learning. It refers to the balance between bias and variance when we are building a model. A model with a high bias makes very strong assumptions about the data and tends to have an underfitting effect, while a higher variance pays more attention to training the data and tends to have an overfitting effect.</p>
<p>Looking at our results aboce, the Linear Regression model might have a high bias if it is oversimplifying the problem and not capturing all the patterns in the data. On the other hand, the Ridge regression might have a high variance if it is overcomplicating the problem and fitting too closely to the training data. By using cross-validation and regularization (which Ridge and Lasso provide), we can achieve a good balance between bias and variance and improve the model’s performance.</p>
<p>Considering the bias-variance tradeoff effect, the Ridge Regression model will be a good fit if future datasets is prone to fluctuations or if it is likely to be more complex data. However, if the dataset is stable, then the Linear Regression Model will be a good fit. Although Linear Regression model had a slightly higher R^2 value, it does not necessarily indicate that it performs well to unseen data.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="references">
<h1>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h1>
<p>sklearn Linear Regression: <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression">https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression</a></p>
<p>sklearn Train Test Split: <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html</a></p>
<p>sklearn cross val score: <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html</a></p>
<p>Negative R^2 Score: <a class="reference external" href="https://towardsdatascience.com/explaining-negative-r-squared-17894ca26321">https://towardsdatascience.com/explaining-negative-r-squared-17894ca26321</a></p>
<p>Bias and Variance Tradeoff: <a class="reference external" href="https://www.analyticsvidhya.com/blog/2020/08/bias-and-variance-tradeoff-machine-learning/">https://www.analyticsvidhya.com/blog/2020/08/bias-and-variance-tradeoff-machine-learning/</a></p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./final_project_demo"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="zhangzidong.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Math 10 Final Project: Analyzing the weather conditions in 10 locations</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">[Predicting CO2 Emissions of Vehicles]</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-exploration">Data Exploration</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preprocessing">Data Preprocessing</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-selection">Feature Selection</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#model-building">Model Building</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#model-improvement">Model Improvement</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ray Zirui Zhang
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>