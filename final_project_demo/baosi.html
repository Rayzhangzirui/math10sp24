
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Predicting NBA Game Outcomes Project &#8212; UCI Math 10, Spring 2024</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'final_project_demo/baosi';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Cancer Prediction Based on Medical and Lifestyle Information" href="caotranhoangthuc.html" />
    <link rel="prev" title="Student Projects" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">UCI Math 10, Spring 2024</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    UC Irvine, Math 10, Fall 2023
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../syllabus.html">Course Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../final_project_instruction.html">Final Project Instruction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../final_project_template.html">[Title here]</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../notes/notes_intro.html">Notes</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notes/python_review.html">Python review</a></li>

<li class="toctree-l2"><a class="reference internal" href="../notes/OOP.html">OOP and Gradient Descent</a></li>


<li class="toctree-l2"><a class="reference internal" href="../notes/prob_stat.html">Probability and Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/pandas.html">Pandas dataframe</a></li>





<li class="toctree-l2"><a class="reference internal" href="../notes/visualization.html">Visualization</a></li>


<li class="toctree-l2"><a class="reference internal" href="../notes/linear_regression.html">Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/multi_linear_reg.html">Multiple Linear Regression</a></li>

<li class="toctree-l2"><a class="reference internal" href="../notes/trade_off.html">Bias-Variance Tradeoff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/cv.html">Cross Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/feature_scaling.html">Feature Scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/regularization.html">Regularization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/logistic_binary.html">Binary Classification with logistic regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/logistic_multiclass.html">Logistic Regression for Multiclass Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/knn.html">Nearest Neighbor Regression and Classification</a></li>

<li class="toctree-l2"><a class="reference internal" href="../notes/pca.html">Dimensionality Reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/kmeans.html">Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/intro_nn.html">Nerual Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/gan.html">Generative Adversarial Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/fairness.html">Bias and Fairness</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lectures/intro.html">Lectures</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week1_Mon.html">week1 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week1_Wed.html">week1 Wed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week1_Fri.html">week1 Fri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week2_Mon.html">week2 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week2_Wed.html">week2 Wed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week2_Fri.html">week2 Fri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week3_Mon.html">week3 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week3_Wed.html">week3 Wed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week3_Fri.html">week3 Fri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week4_Mon.html">week4 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week4_Wed.html">week4 Wed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week4_Fri.html">week4 Fri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week5_Mon.html">week5 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week5_Wed.html">week4 Wed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week6_Mon.html">week6 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week6_Wed.html">week6 Wed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week6_Fri.html">week6 Fri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week7_Mon.html">week7 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week7_Wed.html">week7 Wed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week7_Fri.html">week7 Fri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week8_Mon.html">week8 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week8_Wed.html">week8 Wed</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../homework/intro.html">Homework</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../homework/worksheet_mpg.html">worksheet week 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/worksheet_mpg_sol.html">worksheet week 3 Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/homework1_sol.html">Homework 1 (Due 4/12)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/homework2_sol.html">Homework 2 (Due 4/19)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/homework3_sol.html">Homework 3 (Due 4/26)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/homework4_sol.html">Homework 4 (Due 5/10)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/homework5_sol.html">Homework 5 (Due 5/17)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/homework6_sol.html">Homework 6 (Due 5/24)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/homework7_sol.html">Homework 7 (Due 5/31)</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">Student Projects</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Predicting NBA Game Outcomes Project</a></li>










<li class="toctree-l2"><a class="reference internal" href="caotranhoangthuc.html">Cancer Prediction Based on Medical and Lifestyle Information</a></li>









<li class="toctree-l2"><a class="reference internal" href="changsilas.html">An Analysis of USA Climbing’s Youth Bouldering Series.</a></li>






<li class="toctree-l2"><a class="reference internal" href="chenyu.html">Predicting computer prices using multiple linear regression and decision trees</a></li>








<li class="toctree-l2"><a class="reference internal" href="dabirarjun.html">Analyzing Tennis Match Outcomes in the 2014 Grand Slams</a></li>
<li class="toctree-l2"><a class="reference internal" href="huanganita.html">Youtube Video Trending Prediction</a></li>




<li class="toctree-l2"><a class="reference internal" href="huynhstanley.html">Wine Quality Analysis</a></li>

<li class="toctree-l2"><a class="reference internal" href="jiaoyuhao.html">Analysis of house price forecasts and influencing factors</a></li>




<li class="toctree-l2"><a class="reference internal" href="kimmalex.html">Sleep, Exercise, and UCI Life’s Effect on a College Student’s Health</a></li>
<li class="toctree-l2"><a class="reference internal" href="milleradamchristopher.html">Classifying Songs by Genre using its Features</a></li>





<li class="toctree-l2"><a class="reference internal" href="mongiadron.html">US GDP Forecasting</a></li>













<li class="toctree-l2"><a class="reference internal" href="nguyenalexanderdavid.html">MOVIE SUCCESS IN RELATION TO ITS FILM DISTRIBUTION COMPANY</a></li>







<li class="toctree-l2"><a class="reference internal" href="nguyenmilanngoc.html">LPGA 2022 Rolex Ranking</a></li>
<li class="toctree-l2"><a class="reference internal" href="presnyakovoleg.html">Phone cost prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="roblesisabellaesther.html">Predicting Medical Expenses for Insurance and Analyzing Factors</a></li>





<li class="toctree-l2"><a class="reference internal" href="sonnevillenicolecaroline.html">Predicting ratings on Sephora based on price and number of ingredients</a></li>
<li class="toctree-l2"><a class="reference internal" href="tongbenjaminv.html">Prediction and Classification of Stellar Characteristics</a></li>
<li class="toctree-l2"><a class="reference internal" href="torreshornbeakelijahcharles.html">Methods for Analyzing the Best NBA Players</a></li>

<li class="toctree-l2"><a class="reference internal" href="trancrystal.html">Analysis of Mushroom Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="tranethank.html">Top Valorant Players</a></li>

















<li class="toctree-l2"><a class="reference internal" href="wunathan.html">Image Classfication on “Heart Failure Cinical Records” Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="yangchenxi.html">Analysis of Tesla Stock Price in the most recnet 6 months</a></li>
<li class="toctree-l2"><a class="reference internal" href="zhangzhiwei.html">CO2 Emissions and Renewable Energy Trends</a></li>








<li class="toctree-l2"><a class="reference internal" href="zhangzidong.html">Math 10 Final Project: Analyzing the weather conditions in 10 locations</a></li>




<li class="toctree-l2"><a class="reference internal" href="zhaomickey.html">[Predicting CO2 Emissions of Vehicles]</a></li>








</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/final_project_demo/baosi.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Predicting NBA Game Outcomes Project</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Predicting NBA Game Outcomes Project</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#author-si-bao">Author: Si Bao</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#course-project-uc-irvine-math-10-s24">Course Project, UC Irvine, Math 10, S24</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-would-like-to-post-my-notebook-on-the-courses-website-yes">I would like to post my notebook on the course’s website. Yes</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preparation">Data Preparation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-function">Helper Function</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-models">Linear Models</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression">Linear Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ridge-regression">Ridge Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lasso-regression">Lasso Regression</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#logistic-regression">Logistic Regression</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#k-nearest-neighbor-regression">K-Nearest Neighbor Regression</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#decision-trees">Decision Trees</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#support-vector-machines">Support Vector Machines</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="predicting-nba-game-outcomes-project">
<h1>Predicting NBA Game Outcomes Project<a class="headerlink" href="#predicting-nba-game-outcomes-project" title="Link to this heading">#</a></h1>
<section id="author-si-bao">
<h2>Author: Si Bao<a class="headerlink" href="#author-si-bao" title="Link to this heading">#</a></h2>
</section>
<section id="course-project-uc-irvine-math-10-s24">
<h2>Course Project, UC Irvine, Math 10, S24<a class="headerlink" href="#course-project-uc-irvine-math-10-s24" title="Link to this heading">#</a></h2>
</section>
<section id="i-would-like-to-post-my-notebook-on-the-courses-website-yes">
<h2>I would like to post my notebook on the course’s website. Yes<a class="headerlink" href="#i-would-like-to-post-my-notebook-on-the-courses-website-yes" title="Link to this heading">#</a></h2>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="table-of-contents">
<h1>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">#</a></h1>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#Introduction"><span class="xref myst">Introduction</span></a></p></li>
<li><p><a class="reference internal" href="#Data-Preparation"><span class="xref myst">Data Preparation</span></a></p></li>
<li><p><a class="reference internal" href="#Helper-Function"><span class="xref myst">Helper Function</span></a></p></li>
<li><p><a class="reference internal" href="#Linear-Models"><span class="xref myst">Linear Models</span></a></p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#Linear-Regression"><span class="xref myst">Linear Regression</span></a></p></li>
<li><p><a class="reference internal" href="#Ridge-Regression"><span class="xref myst">Ridge Regression</span></a></p></li>
<li><p><a class="reference internal" href="#Lasso-Regression"><span class="xref myst">Lasso Regression</span></a></p></li>
</ol>
</li>
<li><p><a class="reference internal" href="#Logistic-Regression"><span class="xref myst">Logistic Regression</span></a></p></li>
<li><p><a class="reference internal" href="#K-Nearest-Neighbor-Regression"><span class="xref myst">K-Nearest Neighbor Regression</span></a></p></li>
<li><p><a class="reference internal" href="#Decision-Trees"><span class="xref myst">Decision Trees</span></a></p></li>
<li><p><a class="reference internal" href="#Support-Vector-Machines"><span class="xref myst">Support Vector Machines</span></a></p></li>
<li><p><a class="reference internal" href="#Conclusion"><span class="xref myst">Conclusion</span></a></p></li>
</ol>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h1>
<p><strong>The National Basketball Association (NBA) is a professional basketball league in North America composed of 30 teams (29 in the United States and 1 in Canada). It is one of the major professional sports leagues in the United States and Canada and is considered the premier professional basketball league in the world.
In my project, I will utilize the game data from 2014 to 2021 to predict the points and winning rate of each team</strong></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-preparation">
<h1>Data Preparation<a class="headerlink" href="#data-preparation" title="Link to this heading">#</a></h1>
<p><strong>The section imports all necessary tools, generate all the necessary data, and drop data with missing values</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">Lasso</span><span class="p">,</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span><span class="p">,</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">auc</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">games</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;games.csv&#39;</span><span class="p">)</span>
<span class="n">teams</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;teams.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Team</span> <span class="o">=</span> <span class="n">teams</span><span class="p">[</span><span class="s1">&#39;NICKNAME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">Team_abb</span> <span class="o">=</span> <span class="n">teams</span><span class="p">[</span><span class="s1">&#39;ABBREVIATION&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">ID</span> <span class="o">=</span> <span class="n">teams</span><span class="p">[</span><span class="s1">&#39;TEAM_ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The following two cells describe the teams and the corresponding team ID</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Team</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Hawks&#39;,
 &#39;Celtics&#39;,
 &#39;Pelicans&#39;,
 &#39;Bulls&#39;,
 &#39;Mavericks&#39;,
 &#39;Nuggets&#39;,
 &#39;Rockets&#39;,
 &#39;Clippers&#39;,
 &#39;Lakers&#39;,
 &#39;Heat&#39;,
 &#39;Bucks&#39;,
 &#39;Timberwolves&#39;,
 &#39;Nets&#39;,
 &#39;Knicks&#39;,
 &#39;Magic&#39;,
 &#39;Pacers&#39;,
 &#39;76ers&#39;,
 &#39;Suns&#39;,
 &#39;Trail Blazers&#39;,
 &#39;Kings&#39;,
 &#39;Spurs&#39;,
 &#39;Thunder&#39;,
 &#39;Raptors&#39;,
 &#39;Jazz&#39;,
 &#39;Grizzlies&#39;,
 &#39;Wizards&#39;,
 &#39;Pistons&#39;,
 &#39;Hornets&#39;,
 &#39;Cavaliers&#39;,
 &#39;Warriors&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ID</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1610612737,
 1610612738,
 1610612740,
 1610612741,
 1610612742,
 1610612743,
 1610612745,
 1610612746,
 1610612747,
 1610612748,
 1610612749,
 1610612750,
 1610612751,
 1610612752,
 1610612753,
 1610612754,
 1610612755,
 1610612756,
 1610612757,
 1610612758,
 1610612759,
 1610612760,
 1610612761,
 1610612762,
 1610612763,
 1610612764,
 1610612765,
 1610612766,
 1610612739,
 1610612744]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section drops the rows with missing values</span>
<span class="n">games_clean</span> <span class="o">=</span> <span class="n">games</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section generates the data of each team in each season</span>

<span class="n">Team_data</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># This list will store the performance of each team from 2014 to 2021</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Team</span><span class="p">)):</span>
    <span class="n">temp_team</span> <span class="o">=</span> <span class="n">games_clean</span><span class="p">[(</span><span class="n">games_clean</span><span class="p">[</span><span class="s1">&#39;TEAM_ID_home&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ID</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">games_clean</span><span class="p">[</span><span class="s1">&#39;TEAM_ID_away&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ID</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span>
    <span class="n">temp_team_away</span> <span class="o">=</span> <span class="n">temp_team</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">temp_team</span><span class="o">.</span><span class="n">TEAM_ID_home</span> <span class="o">==</span> <span class="n">ID</span><span class="p">[</span><span class="n">i</span><span class="p">],[</span><span class="s1">&#39;SEASON&#39;</span><span class="p">,</span> <span class="s1">&#39;PTS_home&#39;</span><span class="p">,</span> <span class="s1">&#39;FG_PCT_home&#39;</span><span class="p">,</span> <span class="s1">&#39;FT_PCT_home&#39;</span><span class="p">,</span> <span class="s1">&#39;FG3_PCT_home&#39;</span><span class="p">,</span> <span class="s1">&#39;AST_home&#39;</span><span class="p">,</span> <span class="s1">&#39;REB_home&#39;</span><span class="p">]]</span>
    <span class="n">temp_team_away</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;PTS_home&#39;</span><span class="p">:</span> <span class="s1">&#39;PTS&#39;</span><span class="p">,</span> <span class="s1">&#39;FG_PCT_home&#39;</span><span class="p">:</span> <span class="s1">&#39;FG_PCT&#39;</span><span class="p">,</span> <span class="s1">&#39;FT_PCT_home&#39;</span><span class="p">:</span> <span class="s1">&#39;FT_PCT&#39;</span><span class="p">,</span> <span class="s1">&#39;FG3_PCT_home&#39;</span><span class="p">:</span> <span class="s1">&#39;FG3_PCT&#39;</span><span class="p">,</span> <span class="s1">&#39;AST_home&#39;</span><span class="p">:</span> <span class="s1">&#39;AST&#39;</span><span class="p">,</span> <span class="s1">&#39;REB_home&#39;</span><span class="p">:</span> <span class="s1">&#39;REB&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">temp_team_home</span> <span class="o">=</span> <span class="n">temp_team</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">temp_team</span><span class="o">.</span><span class="n">TEAM_ID_away</span> <span class="o">==</span> <span class="n">ID</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;SEASON&#39;</span><span class="p">,</span> <span class="s1">&#39;PTS_away&#39;</span><span class="p">,</span> <span class="s1">&#39;FG_PCT_away&#39;</span><span class="p">,</span> <span class="s1">&#39;FT_PCT_away&#39;</span><span class="p">,</span> <span class="s1">&#39;FG3_PCT_away&#39;</span><span class="p">,</span> <span class="s1">&#39;AST_away&#39;</span><span class="p">,</span> <span class="s1">&#39;REB_away&#39;</span><span class="p">]]</span>
    <span class="n">temp_team_home</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;PTS_away&#39;</span><span class="p">:</span> <span class="s1">&#39;PTS&#39;</span><span class="p">,</span> <span class="s1">&#39;FG_PCT_away&#39;</span><span class="p">:</span> <span class="s1">&#39;FG_PCT&#39;</span><span class="p">,</span> <span class="s1">&#39;FT_PCT_away&#39;</span><span class="p">:</span> <span class="s1">&#39;FT_PCT&#39;</span><span class="p">,</span> <span class="s1">&#39;FG3_PCT_away&#39;</span><span class="p">:</span> <span class="s1">&#39;FG3_PCT&#39;</span><span class="p">,</span> <span class="s1">&#39;AST_away&#39;</span><span class="p">:</span> <span class="s1">&#39;AST&#39;</span><span class="p">,</span> <span class="s1">&#39;REB_away&#39;</span><span class="p">:</span> <span class="s1">&#39;REB&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">com_team</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">temp_team_away</span><span class="p">,</span> <span class="n">temp_team_home</span><span class="p">],</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">Team_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">com_team</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Feature Explanation</strong>:</p>
<p>PTS_home: Points by home team</p>
<p>FG_PCT_home: ratio of field goals to field goals attempts by home team</p>
<p>FT_PCT_home: ratio of free throws to free throws attempts by home team</p>
<p>FG3_PCT_home: ratio of three-point field goals to three-point field goals attempts by home team</p>
<p>AST_home: number of assists made home team</p>
<p>REB_home: number of rebounds for home team</p>
<p>PTS_away: Points by away team</p>
<p>FG_PCT_away: ratio of field goals to field goals attempts by away team</p>
<p>FT_PCT_away: ratio of free throws to free throws attempts by away team</p>
<p>FG3_PCT_away: ratio of three-point field goals to three-point field goals attempts by away team</p>
<p>AST_away: number of assists made away team</p>
<p>REB_away: number of rebounds for away team</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section creates a new column called &quot;PTS_DIFF_home_away&quot;,</span>
<span class="c1"># which is determined by home team points minus away team points</span>
<span class="n">new_games_clean</span> <span class="o">=</span> <span class="n">games_clean</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">new_games_clean</span><span class="p">[</span><span class="s1">&#39;PTS_DIFF_home_away&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_games_clean</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;PTS_home&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;PTS_away&#39;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">new_games_clean</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GAME_DATE_EST</th>
      <th>GAME_ID</th>
      <th>GAME_STATUS_TEXT</th>
      <th>HOME_TEAM_ID</th>
      <th>VISITOR_TEAM_ID</th>
      <th>SEASON</th>
      <th>TEAM_ID_home</th>
      <th>PTS_home</th>
      <th>FG_PCT_home</th>
      <th>FT_PCT_home</th>
      <th>...</th>
      <th>REB_home</th>
      <th>TEAM_ID_away</th>
      <th>PTS_away</th>
      <th>FG_PCT_away</th>
      <th>FT_PCT_away</th>
      <th>FG3_PCT_away</th>
      <th>AST_away</th>
      <th>REB_away</th>
      <th>HOME_TEAM_WINS</th>
      <th>PTS_DIFF_home_away</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2022-03-12</td>
      <td>22101005</td>
      <td>Final</td>
      <td>1610612748</td>
      <td>1610612750</td>
      <td>2021</td>
      <td>1610612748</td>
      <td>104.0</td>
      <td>0.398</td>
      <td>0.760</td>
      <td>...</td>
      <td>53.0</td>
      <td>1610612750</td>
      <td>113.0</td>
      <td>0.422</td>
      <td>0.875</td>
      <td>0.357</td>
      <td>21.0</td>
      <td>46.0</td>
      <td>0</td>
      <td>-9.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2022-03-12</td>
      <td>22101006</td>
      <td>Final</td>
      <td>1610612741</td>
      <td>1610612739</td>
      <td>2021</td>
      <td>1610612741</td>
      <td>101.0</td>
      <td>0.443</td>
      <td>0.933</td>
      <td>...</td>
      <td>46.0</td>
      <td>1610612739</td>
      <td>91.0</td>
      <td>0.419</td>
      <td>0.824</td>
      <td>0.208</td>
      <td>19.0</td>
      <td>40.0</td>
      <td>1</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2022-03-12</td>
      <td>22101007</td>
      <td>Final</td>
      <td>1610612759</td>
      <td>1610612754</td>
      <td>2021</td>
      <td>1610612759</td>
      <td>108.0</td>
      <td>0.412</td>
      <td>0.813</td>
      <td>...</td>
      <td>52.0</td>
      <td>1610612754</td>
      <td>119.0</td>
      <td>0.489</td>
      <td>1.000</td>
      <td>0.389</td>
      <td>23.0</td>
      <td>47.0</td>
      <td>0</td>
      <td>-11.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2022-03-12</td>
      <td>22101008</td>
      <td>Final</td>
      <td>1610612744</td>
      <td>1610612749</td>
      <td>2021</td>
      <td>1610612744</td>
      <td>122.0</td>
      <td>0.484</td>
      <td>0.933</td>
      <td>...</td>
      <td>55.0</td>
      <td>1610612749</td>
      <td>109.0</td>
      <td>0.413</td>
      <td>0.696</td>
      <td>0.386</td>
      <td>27.0</td>
      <td>39.0</td>
      <td>1</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2022-03-12</td>
      <td>22101009</td>
      <td>Final</td>
      <td>1610612743</td>
      <td>1610612761</td>
      <td>2021</td>
      <td>1610612743</td>
      <td>115.0</td>
      <td>0.551</td>
      <td>0.750</td>
      <td>...</td>
      <td>39.0</td>
      <td>1610612761</td>
      <td>127.0</td>
      <td>0.471</td>
      <td>0.760</td>
      <td>0.387</td>
      <td>28.0</td>
      <td>50.0</td>
      <td>0</td>
      <td>-12.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div></div></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="helper-function">
<h1>Helper Function<a class="headerlink" href="#helper-function" title="Link to this heading">#</a></h1>
<p><strong>This section defines several functions that will later be used for approximation and plotting in order to avoid repeated and long contents</strong></p>
<p>The <strong>‘prediction_with_Linear_Models’</strong> function is used for the <strong>‘Linear Models’</strong> section.
It takes the input of home team name, away team name, and
one of the three linear model names:
<strong>Linear Regression, Ridge Regression, and Lasso Regression</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">prediction_with_Linear_Models</span><span class="p">(</span><span class="n">home</span><span class="p">,</span> <span class="n">away</span><span class="p">,</span> <span class="n">model_name</span><span class="p">):</span>
    <span class="n">home_index</span> <span class="o">=</span> <span class="n">Team</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">home</span><span class="p">)</span>
    <span class="n">away_index</span> <span class="o">=</span> <span class="n">Team</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">away</span><span class="p">)</span>
    <span class="n">home_id</span> <span class="o">=</span> <span class="n">ID</span><span class="p">[</span><span class="n">home_index</span><span class="p">]</span>
    <span class="n">away_id</span> <span class="o">=</span> <span class="n">ID</span><span class="p">[</span><span class="n">away_index</span><span class="p">]</span>
    
    <span class="c1"># set the models for home and away team according to the model_name input</span>
    <span class="k">if</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;Linear Regression&#39;</span><span class="p">:</span>
        <span class="n">model_home</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
        <span class="n">model_away</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;Ridge Regression&#39;</span><span class="p">:</span>
        <span class="n">model_home</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">()</span>
        <span class="n">model_away</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;Lasso Regression&#39;</span><span class="p">:</span>
        <span class="n">model_home</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">()</span>
        <span class="n">model_away</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;This model is not included&#39;</span>
    
    <span class="c1"># set the features(X) and target(y) for approximation</span>
    <span class="n">home_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;FG_PCT_home&#39;</span><span class="p">,</span> <span class="s1">&#39;FT_PCT_home&#39;</span><span class="p">,</span> <span class="s1">&#39;FG3_PCT_home&#39;</span><span class="p">,</span> <span class="s1">&#39;AST_home&#39;</span><span class="p">,</span> <span class="s1">&#39;REB_home&#39;</span><span class="p">]</span>
    <span class="n">home_target</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PTS_home&#39;</span><span class="p">]</span>
    <span class="n">away_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;FG_PCT_away&#39;</span><span class="p">,</span> <span class="s1">&#39;FT_PCT_away&#39;</span><span class="p">,</span> <span class="s1">&#39;FG3_PCT_away&#39;</span><span class="p">,</span> <span class="s1">&#39;AST_away&#39;</span><span class="p">,</span> <span class="s1">&#39;REB_away&#39;</span><span class="p">]</span>
    <span class="n">away_target</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PTS_away&#39;</span><span class="p">]</span>
    
    <span class="c1"># find the correspoding dataset containing both home team and away team from the cleaned big dataset</span>
    <span class="n">temp_team</span> <span class="o">=</span> <span class="n">games_clean</span><span class="p">[(</span><span class="n">games_clean</span><span class="p">[</span><span class="s1">&#39;TEAM_ID_home&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">home_id</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">games_clean</span><span class="p">[</span><span class="s1">&#39;TEAM_ID_away&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">away_id</span><span class="p">)]</span>
    
    <span class="n">X_home</span> <span class="o">=</span> <span class="n">temp_team</span><span class="p">[</span><span class="n">home_features</span><span class="p">]</span>
    <span class="n">y_home</span> <span class="o">=</span> <span class="n">temp_team</span><span class="p">[</span><span class="n">home_target</span><span class="p">]</span>
    
    <span class="n">X_away</span> <span class="o">=</span> <span class="n">temp_team</span><span class="p">[</span><span class="n">away_features</span><span class="p">]</span>
    <span class="n">y_away</span> <span class="o">=</span> <span class="n">temp_team</span><span class="p">[</span><span class="n">away_target</span><span class="p">]</span>
    
    <span class="c1"># fit the model</span>
    <span class="n">model_home</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_home</span><span class="p">,</span> <span class="n">y_home</span><span class="p">)</span>
    <span class="n">model_away</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_away</span><span class="p">,</span> <span class="n">y_away</span><span class="p">)</span>
    
    <span class="c1"># predict the points that home and away team will get using the fitted model</span>
    <span class="n">pred_home</span> <span class="o">=</span> <span class="n">model_home</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_home</span><span class="p">)</span>
    <span class="n">pred_away</span> <span class="o">=</span> <span class="n">model_away</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_away</span><span class="p">)</span>
    
    <span class="c1"># duplicate the dataset so that the original one will not be modified</span>
    <span class="n">temp_team_copy</span> <span class="o">=</span> <span class="n">temp_team</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="c1"># create a new column of predicted points for both teams</span>
    <span class="n">temp_team_copy</span><span class="p">[</span><span class="s1">&#39;PTS_home_pred&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pred_home</span>
    <span class="n">temp_team_copy</span><span class="p">[</span><span class="s1">&#39;PTS_home_away&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pred_away</span>
    
    <span class="c1"># create a new column of predicted home win using the predicted points column above</span>
    <span class="n">temp_team_copy</span><span class="p">[</span><span class="s1">&#39;HOME_TEAM_WINS_pred&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_team_copy</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;PTS_home_pred&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;PTS_home_away&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">temp_team_copy</span><span class="p">[</span><span class="s1">&#39;HOME_TEAM_WINS_pred&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_team_copy</span><span class="p">[</span><span class="s1">&#39;HOME_TEAM_WINS_pred&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    
    <span class="c1"># compare the actual and predicts home win and create a new column to record the True/False results</span>
    <span class="n">temp_team_copy</span><span class="p">[</span><span class="s1">&#39;CORRECT_pred&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_team_copy</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;HOME_TEAM_WINS&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;HOME_TEAM_WINS_pred&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">temp_team_copy</span><span class="p">[</span><span class="s1">&#39;CORRECT_pred&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_team_copy</span><span class="p">[</span><span class="s1">&#39;CORRECT_pred&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    
    <span class="c1"># find the accuracy</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">temp_team_copy</span><span class="p">[</span><span class="s1">&#39;HOME_TEAM_WINS&#39;</span><span class="p">],</span> <span class="n">temp_team_copy</span><span class="p">[</span><span class="s1">&#39;HOME_TEAM_WINS_pred&#39;</span><span class="p">])</span>
    
    <span class="c1"># return a dataset for reporting and graphing</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;mean_HOME_TEAM_WINS_pred&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">temp_team_copy</span><span class="p">[</span><span class="s1">&#39;HOME_TEAM_WINS_pred&#39;</span><span class="p">]),</span>
        <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="n">acc</span><span class="p">,</span>
        <span class="s1">&#39;actual_home_points&#39;</span><span class="p">:</span> <span class="n">y_home</span><span class="p">,</span>
        <span class="s1">&#39;predicted_home_points&#39;</span><span class="p">:</span> <span class="n">pred_home</span><span class="p">,</span>
        <span class="s1">&#39;actual_away_points&#39;</span><span class="p">:</span> <span class="n">y_away</span><span class="p">,</span>
        <span class="s1">&#39;predicted_away_points&#39;</span><span class="p">:</span> <span class="n">pred_away</span><span class="p">,</span>
        <span class="s1">&#39;home_coefficients&#39;</span><span class="p">:</span> <span class="n">model_home</span><span class="o">.</span><span class="n">coef_</span><span class="p">,</span>
        <span class="s1">&#39;home_intercept&#39;</span><span class="p">:</span> <span class="n">model_away</span><span class="o">.</span><span class="n">intercept_</span><span class="p">,</span>
        <span class="s1">&#39;away_coefficients&#39;</span><span class="p">:</span> <span class="n">model_home</span><span class="o">.</span><span class="n">coef_</span><span class="p">,</span>
        <span class="s1">&#39;away_intercept&#39;</span><span class="p">:</span> <span class="n">model_away</span><span class="o">.</span><span class="n">intercept_</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>The <strong>‘prediction_with_Other_Models’</strong> function is used for the <strong>‘Logistic Regression’, ‘Decision Trees’, and ‘Support Vector Machines’</strong> section.
It takes the input of home team name, away team name, and
one of the three model names:
<strong>Logistic Regression, Decision Trees, and Support Vector Machines</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">prediction_with_Other_Models</span><span class="p">(</span><span class="n">home</span><span class="p">,</span> <span class="n">away</span><span class="p">,</span> <span class="n">model_name</span><span class="p">):</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">home_index</span> <span class="o">=</span> <span class="n">Team</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">home</span><span class="p">)</span>
    <span class="n">away_index</span> <span class="o">=</span> <span class="n">Team</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">away</span><span class="p">)</span>
    <span class="n">home_id</span> <span class="o">=</span> <span class="n">ID</span><span class="p">[</span><span class="n">home_index</span><span class="p">]</span>
    <span class="n">away_id</span> <span class="o">=</span> <span class="n">ID</span><span class="p">[</span><span class="n">away_index</span><span class="p">]</span>
    
    <span class="c1"># find the correspoding dataset containing both home team and away team from the cleaned big dataset</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">games_clean</span><span class="p">[(</span><span class="n">games_clean</span><span class="p">[</span><span class="s1">&#39;TEAM_ID_home&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">home_id</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">games_clean</span><span class="p">[</span><span class="s1">&#39;TEAM_ID_away&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">away_id</span><span class="p">)]</span>
    <span class="n">temp_dummy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;TEAM_ID_home&#39;</span><span class="p">,</span> <span class="s1">&#39;TEAM_ID_away&#39;</span><span class="p">])</span>
    
    <span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;FG_PCT_home&#39;</span><span class="p">,</span> <span class="s1">&#39;FT_PCT_home&#39;</span><span class="p">,</span> <span class="s1">&#39;FG3_PCT_home&#39;</span><span class="p">,</span> <span class="s1">&#39;AST_home&#39;</span><span class="p">,</span> <span class="s1">&#39;REB_home&#39;</span><span class="p">,</span> <span class="s1">&#39;FG_PCT_away&#39;</span><span class="p">,</span> <span class="s1">&#39;FT_PCT_away&#39;</span><span class="p">,</span> <span class="s1">&#39;FG3_PCT_away&#39;</span><span class="p">,</span> <span class="s1">&#39;AST_away&#39;</span><span class="p">,</span> <span class="s1">&#39;REB_away&#39;</span><span class="p">]</span>
    <span class="n">target</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;HOME_TEAM_WINS&#39;</span><span class="p">]</span>
    
    <span class="c1"># set the models for home and away team according to the model_name input</span>
    <span class="k">if</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;Logistic Regression&#39;</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span> <span class="o">=</span> <span class="mi">20000</span><span class="p">,</span> <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;lbfgs&#39;</span><span class="p">)</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;Decision Trees&#39;</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span><span class="p">)</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;Support Vector Machines&#39;</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span><span class="p">)</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">temp_dummy</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GAME_DATE_EST&#39;</span><span class="p">,</span> <span class="s1">&#39;GAME_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;GAME_STATUS_TEXT&#39;</span><span class="p">,</span> <span class="s1">&#39;HOME_TEAM_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;SEASON&#39;</span><span class="p">,</span> <span class="s1">&#39;PTS_home&#39;</span><span class="p">,</span> <span class="s1">&#39;VISITOR_TEAM_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;PTS_away&#39;</span><span class="p">,</span> <span class="s1">&#39;HOME_TEAM_WINS&#39;</span><span class="p">])</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">temp_dummy</span><span class="p">[</span><span class="s1">&#39;HOME_TEAM_WINS&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;This model is not included&#39;</span>
    
    <span class="c1"># split data for training and tesing</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span><span class="p">)</span>
    
    <span class="c1"># fit the data</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>    
    <span class="n">y_pred_test</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">)</span>
    
    <span class="c1"># return dataset for reporting and graphing</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
        <span class="s1">&#39;mean_prediction&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_pred</span><span class="p">),</span>
        <span class="s1">&#39;actual_values&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span>
        <span class="s1">&#39;predicted_values&#39;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">,</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>The <strong>‘plot_score’</strong> function is used for plotting the relationship betweenthe predicted and actual points for home and away team</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_score</span><span class="p">(</span><span class="n">home</span><span class="p">,</span> <span class="n">away</span><span class="p">,</span> <span class="n">model_name</span><span class="p">):</span>
    <span class="c1"># get the required data for plotting</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">prediction_with_Linear_Models</span><span class="p">(</span><span class="n">home</span><span class="p">,</span> <span class="n">away</span><span class="p">,</span> <span class="n">model_name</span><span class="p">)</span>
    
    <span class="c1"># store the predicted and actual points for home and away team</span>
    <span class="n">actual_home_points</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;actual_home_points&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">predicted_home_points</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;predicted_home_points&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">actual_away_points</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;actual_away_points&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">predicted_away_points</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;predicted_away_points&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

    <span class="c1"># plot the graph for home team</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">actual_home_points</span><span class="p">,</span> <span class="n">predicted_home_points</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Home Team&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">actual_home_points</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">actual_home_points</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span>
             <span class="p">[</span><span class="n">actual_home_points</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">actual_home_points</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span>
             <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Perfect Prediction&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Actual Home Points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Predicted Home Points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Home Team&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="c1"># plot the graph for away team</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">actual_away_points</span><span class="p">,</span> <span class="n">predicted_away_points</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Away Team&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">actual_away_points</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">actual_away_points</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span>
             <span class="p">[</span><span class="n">actual_away_points</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">actual_away_points</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span>
             <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Perfect Prediction&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Actual Away Points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Predicted Away Points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Away Team&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Actual vs Predicted Points for Home and Away Teams&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The <strong>‘plot_win’</strong> function is used for plotting the relationship between actual and predicted home wins</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_win</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hexbin</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;actual_values&#39;</span><span class="p">],</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;predicted_values&#39;</span><span class="p">],</span> <span class="n">gridsize</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">mincnt</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Count&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Actual Home Win (0 or 1)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Predicted Home Win (0 or 1)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Actual Home Win vs. Predicted Home Win&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="linear-models">
<h1>Linear Models<a class="headerlink" href="#linear-models" title="Link to this heading">#</a></h1>
<section id="linear-regression">
<h2>Linear Regression<a class="headerlink" href="#linear-regression" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section predicts the points each team will have depending on the following features:</span>
<span class="c1"># FG_PCT, PT_PCT, FG3_PCT, AST, REB</span>
<span class="c1"># Model used: Linear Regression</span>

<span class="n">reg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;FG_PCT&#39;</span><span class="p">,</span> <span class="s1">&#39;FT_PCT&#39;</span><span class="p">,</span> <span class="s1">&#39;FG3_PCT&#39;</span><span class="p">,</span> <span class="s1">&#39;AST&#39;</span><span class="p">,</span><span class="s1">&#39;REB&#39;</span><span class="p">]</span>
<span class="n">target</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PTS&#39;</span><span class="p">]</span>

<span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Team_data</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">train_index</span><span class="p">,</span> <span class="n">test_index</span> <span class="ow">in</span> <span class="n">kf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">Team_data</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span> <span class="c1"># Test the prediction using 5-fold cross-validation</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">Team_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_index</span><span class="p">],</span> <span class="n">temp</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>
        <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_index</span><span class="p">],</span> <span class="n">temp</span><span class="p">[</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>
        
        <span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
        
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">score</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7116344958573725
</pre></div>
</div>
</div>
</div>
<p>This average number show that linear regression has an overall high accuracy in predicting total points</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section gives an exmaple of predicting the winning possibility of</span>
<span class="c1"># the home team Dallas Mavericks against the away team Boston Celtics using Linear Regression</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">prediction_with_Linear_Models</span><span class="p">(</span><span class="s1">&#39;Mavericks&#39;</span><span class="p">,</span> <span class="s1">&#39;Celtics&#39;</span><span class="p">,</span> <span class="s1">&#39;Linear Regression&#39;</span><span class="p">)</span>
<span class="n">ave</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;mean_HOME_TEAM_WINS_pred&#39;</span><span class="p">]</span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The predicted possibility that home team Mavericks wins the game against away team Celtics is </span><span class="si">{</span><span class="n">ave</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The accuracy is </span><span class="si">{</span><span class="n">acc</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The predicted possibility that home team Mavericks wins the game against away team Celtics is 0.7894736842105263
The accuracy is 0.8947368421052632
</pre></div>
</div>
</div>
</div>
<p>This example shows that linear regression is quite accurate in predicting the game result between Dallas Mavericks and Boston Celtics</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section visualizes the approximation by Linear Regression</span>

<span class="n">home</span> <span class="o">=</span> <span class="s1">&#39;Mavericks&#39;</span>
<span class="n">away</span> <span class="o">=</span> <span class="s1">&#39;Celtics&#39;</span>

<span class="n">plot_score</span><span class="p">(</span><span class="n">home</span><span class="p">,</span> <span class="n">away</span><span class="p">,</span> <span class="s1">&#39;Linear Regression&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/88f09627d616003ac10b3938cab3bfff602254304c81e412f7e54875d1f6b1df.png" src="../_images/88f09627d616003ac10b3938cab3bfff602254304c81e412f7e54875d1f6b1df.png" />
</div>
</div>
<p>The two graphs show that for both teams, the predicted and actual points are pretty close for over 70 percent of the samples</p>
</section>
<section id="ridge-regression">
<h2>Ridge Regression<a class="headerlink" href="#ridge-regression" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section predicts the points each team will have depending on the following features:</span>
<span class="c1"># FG_PCT, PT_PCT, FG3_PCT, AST, REB</span>
<span class="c1"># Model used: Ridge Regression</span>

<span class="n">ridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;FG_PCT&#39;</span><span class="p">,</span> <span class="s1">&#39;FT_PCT&#39;</span><span class="p">,</span> <span class="s1">&#39;FG3_PCT&#39;</span><span class="p">,</span> <span class="s1">&#39;AST&#39;</span><span class="p">,</span><span class="s1">&#39;REB&#39;</span><span class="p">]</span>
<span class="n">target</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PTS&#39;</span><span class="p">]</span>

<span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Team_data</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">train_index</span><span class="p">,</span> <span class="n">test_index</span> <span class="ow">in</span> <span class="n">kf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">Team_data</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span> <span class="c1"># Test the prediction using 5-fold cross-validation</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">Team_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_index</span><span class="p">],</span> <span class="n">temp</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>
        <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_index</span><span class="p">],</span> <span class="n">temp</span><span class="p">[</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>
        
        <span class="n">ridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">ridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
        
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">score</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7099268435047021
</pre></div>
</div>
</div>
</div>
<p>This average number show that ridge regression has an overall high accuracy in predicting total points</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section gives an exmaple of predicting the winning possibility of</span>
<span class="c1"># the home team Dallas Mavericks against the away team Boston Celtics using Ridge Regression</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">prediction_with_Linear_Models</span><span class="p">(</span><span class="s1">&#39;Mavericks&#39;</span><span class="p">,</span> <span class="s1">&#39;Celtics&#39;</span><span class="p">,</span> <span class="s1">&#39;Ridge Regression&#39;</span><span class="p">)</span>
<span class="n">ave</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;mean_HOME_TEAM_WINS_pred&#39;</span><span class="p">]</span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The predicted possibility that home team Mavericks wins the game against away team Celtics is </span><span class="si">{</span><span class="n">ave</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The accuracy is </span><span class="si">{</span><span class="n">acc</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The predicted possibility that home team Mavericks wins the game against away team Celtics is 0.631578947368421
The accuracy is 0.631578947368421
</pre></div>
</div>
</div>
</div>
<p>This example shows that ridge regression is relatively less accurate in predicting the game result between Dallas Mavericks and Boston Celtics</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section visualizes the approximation by Ridge Regression</span>

<span class="n">home</span> <span class="o">=</span> <span class="s1">&#39;Mavericks&#39;</span>
<span class="n">away</span> <span class="o">=</span> <span class="s1">&#39;Celtics&#39;</span>

<span class="n">plot_score</span><span class="p">(</span><span class="n">home</span><span class="p">,</span> <span class="n">away</span><span class="p">,</span> <span class="s1">&#39;Ridge Regression&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/10edd36ba58a7a62a6a61a055cfa48b89efee2c3a4c52bfb5127fb312e7c8670.png" src="../_images/10edd36ba58a7a62a6a61a055cfa48b89efee2c3a4c52bfb5127fb312e7c8670.png" />
</div>
</div>
<p>The two graphs show that for both teams, the predicted and actual points by ridge regression are more scattered than the graph of linear regression</p>
</section>
<section id="lasso-regression">
<h2>Lasso Regression<a class="headerlink" href="#lasso-regression" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section predicts the points each team will have depending on the following features:</span>
<span class="c1"># FG_PCT, PT_PCT, FG3_PCT, AST, REB</span>
<span class="c1"># Model used: Lasso Regression</span>

<span class="n">lasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;FG_PCT&#39;</span><span class="p">,</span> <span class="s1">&#39;FT_PCT&#39;</span><span class="p">,</span> <span class="s1">&#39;FG3_PCT&#39;</span><span class="p">,</span> <span class="s1">&#39;AST&#39;</span><span class="p">,</span><span class="s1">&#39;REB&#39;</span><span class="p">]</span>
<span class="n">target</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PTS&#39;</span><span class="p">]</span>

<span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Team_data</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">train_index</span><span class="p">,</span> <span class="n">test_index</span> <span class="ow">in</span> <span class="n">kf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">Team_data</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span> <span class="c1"># Test the prediction using 5-fold cross-validation</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">Team_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_index</span><span class="p">],</span> <span class="n">temp</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>
        <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_index</span><span class="p">],</span> <span class="n">temp</span><span class="p">[</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>
        
        <span class="n">lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">lasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
        
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">score</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6612318106475936
</pre></div>
</div>
</div>
</div>
<p>This number shows that lasso regression has an above-average accuracy</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section gives an exmaple of predicting the winning possibility of</span>
<span class="c1"># the home team Dallas Mavericks against the away team Boston Celtics using Lasso Regression</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">prediction_with_Linear_Models</span><span class="p">(</span><span class="s1">&#39;Mavericks&#39;</span><span class="p">,</span> <span class="s1">&#39;Celtics&#39;</span><span class="p">,</span> <span class="s1">&#39;Lasso Regression&#39;</span><span class="p">)</span>
<span class="n">ave</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;mean_HOME_TEAM_WINS_pred&#39;</span><span class="p">]</span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The predicted possibility that home team Mavericks wins the game against away team Celtics is </span><span class="si">{</span><span class="n">ave</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The accuracy is </span><span class="si">{</span><span class="n">acc</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The predicted possibility that home team Mavericks wins the game against away team Celtics is 0.631578947368421
The accuracy is 0.631578947368421
</pre></div>
</div>
</div>
</div>
<p>This example shows that the accuracy is basically the same as the overall accuracy</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section visualizes the approximation by Lasso Regression</span>

<span class="n">home</span> <span class="o">=</span> <span class="s1">&#39;Mavericks&#39;</span>
<span class="n">away</span> <span class="o">=</span> <span class="s1">&#39;Celtics&#39;</span>

<span class="n">plot_score</span><span class="p">(</span><span class="n">home</span><span class="p">,</span> <span class="n">away</span><span class="p">,</span> <span class="s1">&#39;Lasso Regression&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5ce2592885c72b28ae3ff7858390c3d9bd824365b1cf3e7aef996c31d29cf255.png" src="../_images/5ce2592885c72b28ae3ff7858390c3d9bd824365b1cf3e7aef996c31d29cf255.png" />
</div>
</div>
<p>These two graph are similar to those of ridge regression, with minor differences.</p>
<p><strong>Summarizing the three regression tools, we can conclude that linear regression has the best approximation accuracy in predicting the game and points results</strong></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="logistic-regression">
<h1>Logistic Regression<a class="headerlink" href="#logistic-regression" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section generates the overall accuracy by feeding the model with the data of all 30 teams</span>

<span class="n">overall_accuracy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Team</span><span class="p">)):</span>
    <span class="n">temp_team</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span>
    <span class="n">temp_team</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">Team</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_team</span><span class="p">)):</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">prediction_with_Other_Models</span><span class="p">(</span><span class="n">Team</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">temp_team</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="s1">&#39;Logistic Regression&#39;</span><span class="p">)</span>
        <span class="n">overall_accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
        
<span class="n">av_acc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">overall_accuracy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The overall accuracy of predicting the winning rate of each team is </span><span class="si">{</span><span class="n">av_acc</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The overall accuracy of predicting the winning rate of each team is 0.6978113802657413
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section gives an example of predicting the result between two specific games.</span>
<span class="c1"># As an example, we want to predict the result between</span>
<span class="c1"># Boston celtics and Dallas Mavericks using Logistic Regression</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">prediction_with_Other_Models</span><span class="p">(</span><span class="s1">&#39;Mavericks&#39;</span><span class="p">,</span> <span class="s1">&#39;Celtics&#39;</span><span class="p">,</span> <span class="s1">&#39;Logistic Regression&#39;</span><span class="p">)</span>
<span class="n">possi</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;mean_prediction&#39;</span><span class="p">]</span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The predicted winning rate of home team Celtics against away team Mavericks is </span><span class="si">{</span><span class="n">possi</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The overall accuracy is </span><span class="si">{</span><span class="n">acc</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The predicted winning rate of home team Celtics against away team Mavericks is 0.5789473684210527
The overall accuracy is 0.0
</pre></div>
</div>
</div>
</div>
<p>It turns out that logistic regression is not useful in this example, since the accuracu is 0</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section visualizes the approximation by Logistic Regression</span>

<span class="n">home</span> <span class="o">=</span> <span class="s1">&#39;Mavericks&#39;</span>
<span class="n">away</span> <span class="o">=</span> <span class="s1">&#39;Celtics&#39;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">prediction_with_Other_Models</span><span class="p">(</span><span class="n">home</span><span class="p">,</span> <span class="n">away</span><span class="p">,</span> <span class="s1">&#39;Logistic Regression&#39;</span><span class="p">)</span>

<span class="n">plot_win</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f7f69181444e7afadc88efc51a57ea607bcb1866d4856eec26bef100fbfdaf0f.png" src="../_images/f7f69181444e7afadc88efc51a57ea607bcb1866d4856eec26bef100fbfdaf0f.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="k-nearest-neighbor-regression">
<h1>K-Nearest Neighbor Regression<a class="headerlink" href="#k-nearest-neighbor-regression" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This function is individually set in this section because we need to find the best k first</span>
<span class="c1"># I have to change the input &#39;n&#39; in a for loop,</span>
<span class="c1"># so I can&#39;t combine it with the &#39;prediction_with_Other_Models&#39; function</span>

<span class="k">def</span> <span class="nf">prediction_with_KNN_home</span><span class="p">(</span><span class="n">home</span><span class="p">,</span> <span class="n">away</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">home_index</span> <span class="o">=</span> <span class="n">Team</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">home</span><span class="p">)</span>
    <span class="n">away_index</span> <span class="o">=</span> <span class="n">Team</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">away</span><span class="p">)</span>
    <span class="n">home_id</span> <span class="o">=</span> <span class="n">ID</span><span class="p">[</span><span class="n">home_index</span><span class="p">]</span>
    <span class="n">away_id</span> <span class="o">=</span> <span class="n">ID</span><span class="p">[</span><span class="n">away_index</span><span class="p">]</span>
    
    <span class="n">temp</span> <span class="o">=</span> <span class="n">games_clean</span><span class="p">[(</span><span class="n">games_clean</span><span class="p">[</span><span class="s1">&#39;TEAM_ID_home&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">home_id</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">games_clean</span><span class="p">[</span><span class="s1">&#39;TEAM_ID_away&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">away_id</span><span class="p">)]</span>
    <span class="n">temp_dummy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;TEAM_ID_home&#39;</span><span class="p">,</span> <span class="s1">&#39;TEAM_ID_away&#39;</span><span class="p">])</span>
    
    <span class="n">X</span> <span class="o">=</span> <span class="n">temp_dummy</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GAME_DATE_EST&#39;</span><span class="p">,</span> <span class="s1">&#39;GAME_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;GAME_STATUS_TEXT&#39;</span><span class="p">,</span> <span class="s1">&#39;HOME_TEAM_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;SEASON&#39;</span><span class="p">,</span> <span class="s1">&#39;PTS_home&#39;</span><span class="p">,</span> <span class="s1">&#39;VISITOR_TEAM_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;PTS_away&#39;</span><span class="p">,</span> <span class="s1">&#39;HOME_TEAM_WINS&#39;</span><span class="p">])</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">temp_dummy</span><span class="p">[</span><span class="s1">&#39;HOME_TEAM_WINS&#39;</span><span class="p">]</span>
    
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

    <span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span> <span class="o">=</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    
    <span class="n">y_pred_test</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">acc</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section tests the accuracy of KNN model using k-value from 1 to 12 </span>

<span class="n">overall_accuracy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ave_acc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Team</span><span class="p">)):</span>
        <span class="n">temp_team</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span>
        <span class="n">temp_team</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">Team</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_team</span><span class="p">)):</span>
            <span class="n">acc</span><span class="p">,</span> <span class="n">ave_pred</span> <span class="o">=</span> <span class="n">prediction_with_KNN_home</span><span class="p">(</span><span class="n">Team</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">temp_team</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">k</span><span class="p">)</span>
            <span class="n">overall_accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">acc</span><span class="p">)</span>
            
    <span class="n">ave_acc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">overall_accuracy</span><span class="p">))</span>
    
<span class="n">ave_acc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.6341139639415501,
 0.6213082591099833,
 0.6350885980771038,
 0.635928071768589,
 0.640380678708265,
 0.6408117159553941,
 0.6428693515023564,
 0.6433556469871125,
 0.6436807594278858,
 0.6434954470816538,
 0.6431105841215559,
 0.642111453893063]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This part calculates the best value of k for approximation</span>
<span class="n">max_acc</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ave_acc</span><span class="p">)</span>
<span class="n">best_k</span> <span class="o">=</span> <span class="n">ave_acc</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">max_acc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The best k is </span><span class="si">{</span><span class="n">best_k</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The overall accuracy of predicting the winning rate of each team is </span><span class="si">{</span><span class="n">max_acc</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The best k is 9
The overall accuracy of predicting the winning rate of each team is 0.6436807594278858
</pre></div>
</div>
</div>
</div>
<p>KNN model returns an average accuracy, and the best best k in this circumstance is 9</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section gives an example of predicting the result between two specific games.</span>
<span class="c1"># As an example, we want to predict the result between</span>
<span class="c1"># Dallas Mavericks and Boston Celtics using KNN with the best k value we obtained from the cell above</span>

<span class="n">acc</span><span class="p">,</span> <span class="n">possi</span> <span class="o">=</span> <span class="n">prediction_with_KNN_home</span><span class="p">(</span><span class="s1">&#39;Mavericks&#39;</span><span class="p">,</span> <span class="s1">&#39;Celtics&#39;</span><span class="p">,</span> <span class="n">best_k</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The predicted winning rate of home team Dallas Mavericks against away team Boston Celtics is </span><span class="si">{</span><span class="n">possi</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The overall accuracy is </span><span class="si">{</span><span class="n">acc</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The predicted winning rate of home team Dallas Mavericks against away team Boston Celtics is 0.7894736842105263
The overall accuracy is 0.75
</pre></div>
</div>
</div>
</div>
<p>KNN has a pretty good accuracy in this exmaple</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="decision-trees">
<h1>Decision Trees<a class="headerlink" href="#decision-trees" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section generates the overall accuracy by feeding the model with the data of all 30 teams</span>

<span class="n">overall_accuracy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Team</span><span class="p">)):</span>
    <span class="n">temp_team</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span>
    <span class="n">temp_team</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">Team</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_team</span><span class="p">)):</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">prediction_with_Other_Models</span><span class="p">(</span><span class="n">Team</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">temp_team</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="s1">&#39;Decision Trees&#39;</span><span class="p">)</span>
        <span class="n">overall_accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
        
<span class="n">av_acc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">overall_accuracy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The overall accuracy of predicting the winning rate of each team is </span><span class="si">{</span><span class="n">av_acc</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The overall accuracy of predicting the winning rate of each team is 0.6718327363231015
</pre></div>
</div>
</div>
</div>
<p>The Decision Trees model returns an average accuracy</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section gives an example of predicting the result between two specific games.</span>
<span class="c1"># As an example, we want to predict the result between</span>
<span class="c1"># Dallas Mavericks and Minnesota Timberwolves using Decision Trees</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">prediction_with_Other_Models</span><span class="p">(</span><span class="s1">&#39;Mavericks&#39;</span><span class="p">,</span> <span class="s1">&#39;Celtics&#39;</span><span class="p">,</span> <span class="s1">&#39;Decision Trees&#39;</span><span class="p">)</span>

<span class="n">possi</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;mean_prediction&#39;</span><span class="p">]</span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The predicted winning rate of home team Dallas Maverick against away team Minnesota Timberwolves is </span><span class="si">{</span><span class="n">possi</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The overall accuracy is </span><span class="si">{</span><span class="n">acc</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The predicted winning rate of home team Dallas Maverick against away team Minnesota Timberwolves is 0.631578947368421
The overall accuracy is 0.5
</pre></div>
</div>
</div>
</div>
<p>The Decision Trees model does not give a vey good accuracy in this example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section visualizes the approximation of home wins using Decision Trees</span>

<span class="n">home</span> <span class="o">=</span> <span class="s1">&#39;Mavericks&#39;</span>
<span class="n">away</span> <span class="o">=</span> <span class="s1">&#39;Celtics&#39;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">prediction_with_Other_Models</span><span class="p">(</span><span class="n">home</span><span class="p">,</span> <span class="n">away</span><span class="p">,</span> <span class="s1">&#39;Decision Trees&#39;</span><span class="p">)</span>

<span class="n">plot_win</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e953d9a52bce34fa42cbca5d787429f011b120d5195a4691c4627a710239b099.png" src="../_images/e953d9a52bce34fa42cbca5d787429f011b120d5195a4691c4627a710239b099.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="support-vector-machines">
<h1>Support Vector Machines<a class="headerlink" href="#support-vector-machines" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section generates the overall accuracy by feeding the model with the data of all 30 teams</span>

<span class="n">overall_accuracy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Team</span><span class="p">)):</span>
    <span class="n">temp_team</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span>
    <span class="n">temp_team</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">Team</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_team</span><span class="p">)):</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">prediction_with_Other_Models</span><span class="p">(</span><span class="n">Team</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">temp_team</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="s1">&#39;Support Vector Machines&#39;</span><span class="p">)</span>
        <span class="n">overall_accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
        
<span class="n">av_acc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">overall_accuracy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The overall accuracy of predicting the winning rate of each team is </span><span class="si">{</span><span class="n">av_acc</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The overall accuracy of predicting the winning rate of each team is 0.585768289257133
</pre></div>
</div>
</div>
</div>
<p>SVM gives a relatively lowest accuracy, which implies that SVM may not be suitable for prediction of NBA game results</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section gives an example of predicting the result between two specific games.</span>
<span class="c1"># As an example, we want to predict the result between</span>
<span class="c1"># Dallas Mavericks and Minnesota Timberwolves using Support Vector Machine</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">prediction_with_Other_Models</span><span class="p">(</span><span class="s1">&#39;Mavericks&#39;</span><span class="p">,</span> <span class="s1">&#39;Celtics&#39;</span><span class="p">,</span> <span class="s1">&#39;Support Vector Machines&#39;</span><span class="p">)</span>

<span class="n">possi</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;mean_prediction&#39;</span><span class="p">]</span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The predicted winning rate of home team Dallas Mavericks against away team Minnesota Timberwolves is </span><span class="si">{</span><span class="n">possi</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The overall accuracy is </span><span class="si">{</span><span class="n">acc</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The predicted winning rate of home team Dallas Mavericks against away team Minnesota Timberwolves is 1.0
The overall accuracy is 0.6666666666666666
</pre></div>
</div>
</div>
</div>
<p>SVM has an average performance in this example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This section visualizes the approximation of home wins using Support Vector Machines</span>

<span class="n">home</span> <span class="o">=</span> <span class="s1">&#39;Mavericks&#39;</span>
<span class="n">away</span> <span class="o">=</span> <span class="s1">&#39;Celtics&#39;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">prediction_with_Other_Models</span><span class="p">(</span><span class="n">home</span><span class="p">,</span> <span class="n">away</span><span class="p">,</span> <span class="s1">&#39;Support Vector Machines&#39;</span><span class="p">)</span>

<span class="n">plot_win</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d0e962bfdb04767ccfc097fcc6f6f521efc8fccacda9505abfb83164d570abd3.png" src="../_images/d0e962bfdb04767ccfc097fcc6f6f521efc8fccacda9505abfb83164d570abd3.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="conclusion">
<h1>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h1>
<p><strong>In this project, I try to predict the NBA game outcomes using 7 Machine Learning tools. Three of the tools are used for predicting total points of home and away team, and four of them are used for predicting home team wins. Linear Regression gives the best accuracy score: 71.16%, while Support Vector Machines yields the worst: 58.58%. Nonetheless, the outcomes emphasize that Machine Learning is promising in the field of basketball game predictions.</strong></p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./final_project_demo"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Student Projects</p>
      </div>
    </a>
    <a class="right-next"
       href="caotranhoangthuc.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Cancer Prediction Based on Medical and Lifestyle Information</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Predicting NBA Game Outcomes Project</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#author-si-bao">Author: Si Bao</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#course-project-uc-irvine-math-10-s24">Course Project, UC Irvine, Math 10, S24</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-would-like-to-post-my-notebook-on-the-courses-website-yes">I would like to post my notebook on the course’s website. Yes</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preparation">Data Preparation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-function">Helper Function</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-models">Linear Models</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression">Linear Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ridge-regression">Ridge Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lasso-regression">Lasso Regression</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#logistic-regression">Logistic Regression</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#k-nearest-neighbor-regression">K-Nearest Neighbor Regression</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#decision-trees">Decision Trees</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#support-vector-machines">Support Vector Machines</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ray Zirui Zhang
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>