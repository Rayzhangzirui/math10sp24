
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>US GDP Forecasting &#8212; UCI Math 10, Spring 2024</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'final_project_demo/mongiadron';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="MOVIE SUCCESS IN RELATION TO ITS FILM DISTRIBUTION COMPANY" href="nguyenalexanderdavid.html" />
    <link rel="prev" title="Classifying Songs by Genre using its Features" href="milleradamchristopher.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">UCI Math 10, Spring 2024</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    UC Irvine, Math 10, Spring 2024
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../syllabus.html">Course Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../final_project_instruction.html">Final Project Instruction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../final_project_template.html">[Title here]</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../notes/notes_intro.html">Notes</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../notes/python_review.html">Python review</a></li>

<li class="toctree-l2"><a class="reference internal" href="../notes/OOP.html">OOP and Gradient Descent</a></li>


<li class="toctree-l2"><a class="reference internal" href="../notes/prob_stat.html">Probability and Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/pandas.html">Pandas dataframe</a></li>





<li class="toctree-l2"><a class="reference internal" href="../notes/visualization.html">Visualization</a></li>


<li class="toctree-l2"><a class="reference internal" href="../notes/linear_regression.html">Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/multi_linear_reg.html">Multiple Linear Regression</a></li>

<li class="toctree-l2"><a class="reference internal" href="../notes/trade_off.html">Bias-Variance Tradeoff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/cv.html">Cross Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/feature_scaling.html">Feature Scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/regularization.html">Regularization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/logistic_binary.html">Binary Classification with logistic regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/logistic_multiclass.html">Logistic Regression for Multiclass Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/knn.html">Nearest Neighbor Regression and Classification</a></li>

<li class="toctree-l2"><a class="reference internal" href="../notes/pca.html">Dimensionality Reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/kmeans.html">Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/intro_nn.html">Nerual Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/gan.html">Generative Adversarial Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/fairness.html">Bias and Fairness</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lectures/intro.html">Lectures</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week1_Mon.html">week1 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week1_Wed.html">week1 Wed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week1_Fri.html">week1 Fri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week2_Mon.html">week2 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week2_Wed.html">week2 Wed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week2_Fri.html">week2 Fri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week3_Mon.html">week3 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week3_Wed.html">week3 Wed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week3_Fri.html">week3 Fri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week4_Mon.html">week4 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week4_Wed.html">week4 Wed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week4_Fri.html">week4 Fri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week5_Mon.html">week5 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week5_Wed.html">week4 Wed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week6_Mon.html">week6 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week6_Wed.html">week6 Wed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week6_Fri.html">week6 Fri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week7_Mon.html">week7 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week7_Wed.html">week7 Wed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week7_Fri.html">week7 Fri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week8_Mon.html">week8 Mon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/week8_Wed.html">week8 Wed</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">Student Projects</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="baosi.html">Predicting NBA Game Outcomes Project</a></li>










<li class="toctree-l2"><a class="reference internal" href="caotranhoangthuc.html">Cancer Prediction Based on Medical and Lifestyle Information</a></li>









<li class="toctree-l2"><a class="reference internal" href="changsilas.html">An Analysis of USA Climbing’s Youth Bouldering Series.</a></li>






<li class="toctree-l2"><a class="reference internal" href="chenyu.html">Predicting computer prices using multiple linear regression and decision trees</a></li>








<li class="toctree-l2"><a class="reference internal" href="dabirarjun.html">Analyzing Tennis Match Outcomes in the 2014 Grand Slams</a></li>
<li class="toctree-l2"><a class="reference internal" href="huanganita.html">Youtube Video Trending Prediction</a></li>




<li class="toctree-l2"><a class="reference internal" href="huynhstanley.html">Wine Quality Analysis</a></li>

<li class="toctree-l2"><a class="reference internal" href="jiaoyuhao.html">Analysis of house price forecasts and influencing factors</a></li>




<li class="toctree-l2"><a class="reference internal" href="kimmalex.html">Sleep, Exercise, and UCI Life’s Effect on a College Student’s Health</a></li>
<li class="toctree-l2"><a class="reference internal" href="milleradamchristopher.html">Classifying Songs by Genre using its Features</a></li>





<li class="toctree-l2 current active"><a class="current reference internal" href="#">US GDP Forecasting</a></li>













<li class="toctree-l2"><a class="reference internal" href="nguyenalexanderdavid.html">MOVIE SUCCESS IN RELATION TO ITS FILM DISTRIBUTION COMPANY</a></li>







<li class="toctree-l2"><a class="reference internal" href="nguyenmilanngoc.html">LPGA 2022 Rolex Ranking</a></li>
<li class="toctree-l2"><a class="reference internal" href="presnyakovoleg.html">Phone cost prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="roblesisabellaesther.html">Predicting Medical Expenses for Insurance and Analyzing Factors</a></li>





<li class="toctree-l2"><a class="reference internal" href="sonnevillenicolecaroline.html">Predicting ratings on Sephora based on price and number of ingredients</a></li>
<li class="toctree-l2"><a class="reference internal" href="tongbenjaminv.html">Prediction and Classification of Stellar Characteristics</a></li>
<li class="toctree-l2"><a class="reference internal" href="torreshornbeakelijahcharles.html">Methods for Analyzing the Best NBA Players</a></li>

<li class="toctree-l2"><a class="reference internal" href="trancrystal.html">Analysis of Mushroom Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="tranethank.html">Top Valorant Players</a></li>

















<li class="toctree-l2"><a class="reference internal" href="wunathan.html">Image Classfication on “Heart Failure Cinical Records” Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="yangchenxi.html">Analysis of Tesla Stock Price in the most recnet 6 months</a></li>
<li class="toctree-l2"><a class="reference internal" href="zhangzhiwei.html">CO2 Emissions and Renewable Energy Trends</a></li>








<li class="toctree-l2"><a class="reference internal" href="zhangzidong.html">Math 10 Final Project: Analyzing the weather conditions in 10 locations</a></li>




<li class="toctree-l2"><a class="reference internal" href="zhaomickey.html">[Predicting CO2 Emissions of Vehicles]</a></li>








</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/final_project_demo/mongiadron.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>US GDP Forecasting</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">US GDP Forecasting</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation-and-procedure">Motivation and Procedure</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-creation">Feature Creation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#eda">EDA</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling">Modeling</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#var-forecasting">VAR forecasting</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#vecm-forecasting">VECM forecasting</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#machine-learning-forecasting">Machine Learning forecasting</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#train-test-split">Train-Test Split</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forests">Random Forests</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#knn">KNN</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">Conclusions</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#challenges-and-areas-of-improvement">Challenges and Areas of Improvement</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="us-gdp-forecasting">
<h1>US GDP Forecasting<a class="headerlink" href="#us-gdp-forecasting" title="Link to this heading">#</a></h1>
<p>Author: Dron Mongia</p>
<p>Course Project, UC Irvine, Math 10, S24</p>
<p>I would like to post my notebook on the course’s website: Yes</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="motivation-and-procedure">
<h1>Motivation and Procedure<a class="headerlink" href="#motivation-and-procedure" title="Link to this heading">#</a></h1>
<p>GDP is a very strong metric of a country’s economic wellbeing and therefore, forecasts of GDP are highly sought after. Policy makers and legislators, for example, may want to have a rough forecast of the trends regarding the country’s GDP prior to passing some new bill or law. My procedure for this project will be to first compile time series data from the FRED api consisting of some economic metrics closely related to GDP (GDP = Consumption + Investment + Govt. Spending + Net Export). We then will conduct a series of exploratory tests to better understand our data, and finally we will use a vairety of models (including machine learning methods) to see which one provides the most accurate forecast.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fredapi</span> <span class="k">as</span> <span class="nn">fd</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="feature-creation">
<h1>Feature Creation<a class="headerlink" href="#feature-creation" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fred</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="n">Fred</span><span class="p">(</span><span class="n">api_key</span> <span class="o">=</span> <span class="s1">&#39;efdb939ff3f6b3129c564ef0aa34a91e&#39;</span><span class="p">)</span> <span class="c1"># generally this should be hidden, however for the purposes of this project I will keep it visible</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gen_df</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">series</span><span class="p">):</span>
    <span class="n">gen_ser</span> <span class="o">=</span> <span class="n">fred</span><span class="o">.</span><span class="n">get_series</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">gen_ser</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">category</span> <span class="o">+</span> <span class="s1">&#39; : Billions of dollars&#39;</span><span class="p">:</span> <span class="n">gen_ser</span><span class="o">.</span><span class="n">values</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">merge_dataframes</span><span class="p">(</span><span class="n">dataframes</span><span class="p">,</span> <span class="n">on_column</span><span class="p">):</span>
    <span class="n">merged_df</span> <span class="o">=</span> <span class="n">dataframes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">dataframes</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">merged_df</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">on_column</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">merged_df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataframes_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">gen_df</span><span class="p">(</span><span class="s1">&#39;GDP&#39;</span><span class="p">,</span> <span class="s1">&#39;GDP&#39;</span><span class="p">),</span>
    <span class="n">gen_df</span><span class="p">(</span><span class="s1">&#39;PCE&#39;</span><span class="p">,</span> <span class="s1">&#39;PCE&#39;</span><span class="p">),</span>
    <span class="n">gen_df</span><span class="p">(</span><span class="s1">&#39;GPDI&#39;</span><span class="p">,</span> <span class="s1">&#39;GPDI&#39;</span><span class="p">),</span>
    <span class="n">gen_df</span><span class="p">(</span><span class="s1">&#39;NETEXP&#39;</span><span class="p">,</span> <span class="s1">&#39;NETEXP&#39;</span><span class="p">),</span>
    <span class="n">gen_df</span><span class="p">(</span><span class="s1">&#39;GovTotExp&#39;</span><span class="p">,</span> <span class="s1">&#39;W068RCQ027SBEA&#39;</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">merge_dataframes</span><span class="p">(</span><span class="n">dataframes_list</span><span class="p">,</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>GDP : Billions of dollars</th>
      <th>PCE : Billions of dollars</th>
      <th>GPDI : Billions of dollars</th>
      <th>NETEXP : Billions of dollars</th>
      <th>GovTotExp : Billions of dollars</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1960-01-01</td>
      <td>542.648</td>
      <td>326.4</td>
      <td>96.476</td>
      <td>2.858</td>
      <td>144.233</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1960-04-01</td>
      <td>541.080</td>
      <td>332.2</td>
      <td>87.096</td>
      <td>3.395</td>
      <td>147.417</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1960-07-01</td>
      <td>545.604</td>
      <td>332.1</td>
      <td>86.377</td>
      <td>4.682</td>
      <td>150.459</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1960-10-01</td>
      <td>540.197</td>
      <td>334.0</td>
      <td>75.963</td>
      <td>5.880</td>
      <td>153.780</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1961-01-01</td>
      <td>545.018</td>
      <td>334.5</td>
      <td>78.378</td>
      <td>5.902</td>
      <td>157.254</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>252</th>
      <td>2023-01-01</td>
      <td>26813.601</td>
      <td>18269.6</td>
      <td>4725.828</td>
      <td>-825.687</td>
      <td>9326.383</td>
    </tr>
    <tr>
      <th>253</th>
      <td>2023-04-01</td>
      <td>27063.012</td>
      <td>18419.0</td>
      <td>4780.290</td>
      <td>-806.093</td>
      <td>9422.404</td>
    </tr>
    <tr>
      <th>254</th>
      <td>2023-07-01</td>
      <td>27610.128</td>
      <td>18679.5</td>
      <td>4915.033</td>
      <td>-779.231</td>
      <td>10007.677</td>
    </tr>
    <tr>
      <th>255</th>
      <td>2023-10-01</td>
      <td>27956.998</td>
      <td>18914.5</td>
      <td>4954.426</td>
      <td>-783.734</td>
      <td>9700.808</td>
    </tr>
    <tr>
      <th>256</th>
      <td>2024-01-01</td>
      <td>28255.928</td>
      <td>19164.2</td>
      <td>5004.419</td>
      <td>-850.094</td>
      <td>9924.229</td>
    </tr>
  </tbody>
</table>
<p>257 rows × 6 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Date_col</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span> <span class="c1"># to be used later on</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Date_col</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>231   2017-10-01
232   2018-01-01
233   2018-04-01
234   2018-07-01
235   2018-10-01
236   2019-01-01
237   2019-04-01
238   2019-07-01
239   2019-10-01
240   2020-01-01
241   2020-04-01
242   2020-07-01
243   2020-10-01
244   2021-01-01
245   2021-04-01
246   2021-07-01
247   2021-10-01
248   2022-01-01
249   2022-04-01
250   2022-07-01
251   2022-10-01
252   2023-01-01
253   2023-04-01
254   2023-07-01
255   2023-10-01
256   2024-01-01
Name: Date, dtype: datetime64[ns]
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="eda">
<h1>EDA<a class="headerlink" href="#eda" title="Link to this heading">#</a></h1>
<p>Below is a simple line plot comparing each of the time series. We notice that some of the features resemble GDP far more than others, however, we can not yet begin selecting and removing certain features prior do conducting more exploratory tests.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">date_column</span> <span class="o">=</span> <span class="s1">&#39;Date&#39;</span>

<span class="n">feature_columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">difference</span><span class="p">([</span><span class="n">date_column</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Features vs Time&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">feature_columns</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">date_column</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_columns</span><span class="p">)))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Billions of Dollars&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Show the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d21e850d971d58fdb2da348a14875416e1b8e0f6cfe0c6bb7c9d1ce8c1bdc0ad.png" src="../_images/d21e850d971d58fdb2da348a14875416e1b8e0f6cfe0c6bb7c9d1ce8c1bdc0ad.png" />
</div>
</div>
<p>Here we run a test to evaluate the stationarity of out time series. Stationarity essentially means that a time series has a constant mean and varience. This is important to test for because many popular forecasting methods require stationarity to function properly. Although we can determine the stationarity for most of these time series just by looking at the graph, doing the testing is still beneficial because we will likely reuse it in later parts of the forecast.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">adfuller</span>

<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">column</span> <span class="o">!=</span> <span class="s1">&#39;Date&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ADF Statistic for </span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-value for </span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Critical Values:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">40</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Statistic for GDP : Billions of dollars: 7.301049607594838
P-value for GDP : Billions of dollars: 1.0
Critical Values:
  1%: -3.4562572510874396
  5%: -2.8729420379793598
  10%: -2.5728461399461744

========================================

ADF Statistic for PCE : Billions of dollars: 6.798336970342141
P-value for PCE : Billions of dollars: 1.0
Critical Values:
  1%: -3.4562572510874396
  5%: -2.8729420379793598
  10%: -2.5728461399461744

========================================

ADF Statistic for GPDI : Billions of dollars: 2.765116699661126
P-value for GPDI : Billions of dollars: 1.0
Critical Values:
  1%: -3.4561550092339512
  5%: -2.8728972266578676
  10%: -2.5728222369384763

========================================

ADF Statistic for NETEXP : Billions of dollars: -0.009808856906310032
P-value for NETEXP : Billions of dollars: 0.9577133440470131
Critical Values:
  1%: -3.4565688966099373
  5%: -2.8730786194395455
  10%: -2.5729189953388762

========================================

ADF Statistic for GovTotExp : Billions of dollars: 2.7291557866089486
P-value for GovTotExp : Billions of dollars: 0.9990880001645039
Critical Values:
  1%: -3.4577787098622674
  5%: -2.873608704758507
  10%: -2.573201765981991

========================================
</pre></div>
</div>
</div>
</div>
<p>The numbers we are interested from this test are the P-values. A P-value close to zero (equal to or less than 0.05) implies stationarity while a value closer to 1 implies nonstationarity. We can see that all of our time series are highly unstationary due to their statistically insignificant p-values, in other words we are unable to reject the null hypothesis for stationarity. Below is a simple visual representation of the test. The red dotted line represents the P-value where we would be able to determine stationarity for the time series, the blue box represents the P-value where we are at currently.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adf_results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">column</span> <span class="o">!=</span> <span class="s1">&#39;Date&#39;</span><span class="p">:</span>  
        <span class="n">result</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">])</span>
        <span class="n">adf_results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;Feature&#39;</span><span class="p">:</span> <span class="n">column</span><span class="p">,</span>
            <span class="s1">&#39;ADF Statistic&#39;</span><span class="p">:</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;P-value&#39;</span><span class="p">:</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="s1">&#39;Critical Values&#39;</span><span class="p">:</span> <span class="n">result</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="p">})</span>

<span class="n">adf_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">adf_results</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">adf_df</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">adf_df</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">adf_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">adf_df</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">axes</span>  

    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Feature&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_P-value&#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;P-value&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Feature&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_P-value&#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;P-value&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.005</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;P-value&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ADF Test Results for </span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;Feature&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Significance Level (0.05)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/44e75d8067f56a6d1e8ff70190e05ed35407fa46c5bc3c5569543d601e74a46f.png" src="../_images/44e75d8067f56a6d1e8ff70190e05ed35407fa46c5bc3c5569543d601e74a46f.png" />
</div>
</div>
<p>Below is a VIF (variance inflation factor) test. The purpose is to check for multicollinearity, or the degree of correlation the predictors share with one another. High multicollineaity is not necessairly detrimental for our forecast, however, it can make it much harder for us to determine the individual effect of each feature time series for the prediction, thus hurting the interpretability of the model. Usually a score less than 5 implies no multicollinearity, implying that our features are extremely higly correlated with one another. This will play into our model selection for later.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.stats.outliers_influence</span> <span class="kn">import</span> <span class="n">variance_inflation_factor</span>


<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
<span class="n">X</span><span class="p">[</span><span class="s1">&#39;intercept&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[[</span><span class="s1">&#39;intercept&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X</span> <span class="k">if</span> <span class="n">col</span> <span class="o">!=</span> <span class="s1">&#39;intercept&#39;</span><span class="p">]]</span>

<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Feature&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> 
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Feature&quot;</span><span class="p">],</span> <span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;VIF Scores for Features&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Features&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;VIF Score&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\Dronm\AppData\Local\Temp\ipykernel_49020\2334127177.py:5: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  X[&#39;intercept&#39;] = 1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                           Feature         VIF
0        PCE : Billions of dollars  170.028884
1       GPDI : Billions of dollars   77.277626
2     NETEXP : Billions of dollars    7.335556
3  GovTotExp : Billions of dollars   52.196119
</pre></div>
</div>
<img alt="../_images/87bc8d141f5284e4ad6e573e733b4335f192ed48cf4e111fc9f154020e3552a2.png" src="../_images/87bc8d141f5284e4ad6e573e733b4335f192ed48cf4e111fc9f154020e3552a2.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modeling">
<h1>Modeling<a class="headerlink" href="#modeling" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="var-forecasting">
<h1>VAR forecasting<a class="headerlink" href="#var-forecasting" title="Link to this heading">#</a></h1>
<p>To use the Vector Auto Regression (VAR) model we need to first ensure our data is stationary. we can achieve this using a technique called differencing which essentially is a tranformation of the raw data. It is defined mathematically as
y’(t) = y(t)-y(t-1). We are taking values from our time series and calculating the change which occured following the previous point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_diff</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">data_diff</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">data_diff</span><span class="p">[</span><span class="n">column</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ADF Statistic for </span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-value for </span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Critical Values:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">40</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Statistic for GDP : Billions of dollars: -3.906538294382316
P-value for GDP : Billions of dollars: 0.0019872523174590214
Critical Values:
  1%: -3.4566744514553016
  5%: -2.8731248767783426
  10%: -2.5729436702592023

========================================

ADF Statistic for PCE : Billions of dollars: -6.0438368049790725
P-value for PCE : Billions of dollars: 1.3263283721705999e-07
Critical Values:
  1%: -3.4564641849494113
  5%: -2.873032730098417
  10%: -2.572894516864816

========================================

ADF Statistic for GPDI : Billions of dollars: -14.67874111897741
P-value for GPDI : Billions of dollars: 3.180913951450319e-27
Critical Values:
  1%: -3.4562572510874396
  5%: -2.8729420379793598
  10%: -2.5728461399461744

========================================

ADF Statistic for NETEXP : Billions of dollars: -8.837398948334888
P-value for NETEXP : Billions of dollars: 1.7044265762844e-14
Critical Values:
  1%: -3.4565688966099373
  5%: -2.8730786194395455
  10%: -2.5729189953388762

========================================

ADF Statistic for GovTotExp : Billions of dollars: -3.110199822877988
P-value for GovTotExp : Billions of dollars: 0.0258075066297484
Critical Values:
  1%: -3.4577787098622674
  5%: -2.873608704758507
  10%: -2.573201765981991

========================================
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Features vs Time&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_diff</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">data_diff</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_diff</span><span class="o">.</span><span class="n">columns</span><span class="p">)))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Difference&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Show the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5e4a4958a9167337742bcf09375e1e56bb9887b3de8183ecb2f5e6e76a12e202.png" src="../_images/5e4a4958a9167337742bcf09375e1e56bb9887b3de8183ecb2f5e6e76a12e202.png" />
</div>
</div>
<p>Below is an Autocorrelation Function (ACF) plot which tells us the significance that previous lags have to the current lag. This is usually helpful in evaluating factors like seasonality which are important for certain models. We can see that for the most part, previous lags have reasonably small scores in relation to our time series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span>

<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">data_diff</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">column</span> <span class="o">!=</span> <span class="s1">&#39;Date&#39;</span><span class="p">:</span>  
        <span class="n">plot_acf</span><span class="p">(</span><span class="n">data_diff</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Autocorrelation Function (ACF) - </span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lag&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Autocorrelation&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4602fdf7479d52d8e02f9943871559f010e758a21c71a5505c2d9e5ac7d79eab.png" src="../_images/4602fdf7479d52d8e02f9943871559f010e758a21c71a5505c2d9e5ac7d79eab.png" />
<img alt="../_images/469f846f7e88ea1fd7c607c5ca7cc9b680b9bc2f38d32e65361abb83a84d4cea.png" src="../_images/469f846f7e88ea1fd7c607c5ca7cc9b680b9bc2f38d32e65361abb83a84d4cea.png" />
<img alt="../_images/3af28c73b3f4eef02be16c06ff694513d94631aeda5710154001e65ba6dbb324.png" src="../_images/3af28c73b3f4eef02be16c06ff694513d94631aeda5710154001e65ba6dbb324.png" />
<img alt="../_images/7152618fca96a417242aed3266a5126cc8a9e530c0ac835df7e46e1e463571ee.png" src="../_images/7152618fca96a417242aed3266a5126cc8a9e530c0ac835df7e46e1e463571ee.png" />
<img alt="../_images/89a04552491d9d1e84c7687ec55dc8899964c18ce3b44b0beef0dd62509174bb.png" src="../_images/89a04552491d9d1e84c7687ec55dc8899964c18ce3b44b0beef0dd62509174bb.png" />
</div>
</div>
<p>From the ADF test along with the plot we can determine that our data is now centered around the mean. Our next step is to perform a granger causality test which indicates to us if a lagged verison of a specific time series can help us predict out target time series, however not necessairly that one time series causes the other.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">grangercausalitytests</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PCE : Billions of dollars&#39;</span><span class="p">,</span> <span class="s1">&#39;GPDI : Billions of dollars&#39;</span><span class="p">,</span> <span class="s1">&#39;NETEXP : Billions of dollars&#39;</span><span class="p">,</span> <span class="s1">&#39;GovTotExp : Billions of dollars&#39;</span><span class="p">]</span>
<span class="n">lags</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="c1">#determined from individually testing each combination</span>

<span class="k">for</span> <span class="n">column</span><span class="p">,</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">lags</span><span class="p">):</span>
    <span class="n">df_new</span> <span class="o">=</span> <span class="n">data_diff</span><span class="p">[[</span><span class="s1">&#39;GDP : Billions of dollars&#39;</span><span class="p">,</span> <span class="n">column</span><span class="p">]]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;For: </span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">gc_res</span> <span class="o">=</span> <span class="n">grangercausalitytests</span><span class="p">(</span><span class="n">df_new</span><span class="p">,</span> <span class="n">lag</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">40</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>For: PCE : Billions of dollars

Granger Causality
number of lags (no zero) 1
ssr based F test:         F=0.8821  , p=0.3485  , df_denom=252, df_num=1
ssr based chi2 test:   chi2=0.8926  , p=0.3448  , df=1
likelihood ratio test: chi2=0.8910  , p=0.3452  , df=1
parameter F test:         F=0.8821  , p=0.3485  , df_denom=252, df_num=1

Granger Causality
number of lags (no zero) 2
ssr based F test:         F=0.7486  , p=0.4741  , df_denom=249, df_num=2
ssr based chi2 test:   chi2=1.5273  , p=0.4660  , df=2
likelihood ratio test: chi2=1.5228  , p=0.4670  , df=2
parameter F test:         F=0.7486  , p=0.4741  , df_denom=249, df_num=2

Granger Causality
number of lags (no zero) 3
ssr based F test:         F=0.9103  , p=0.4366  , df_denom=246, df_num=3
ssr based chi2 test:   chi2=2.8087  , p=0.4221  , df=3
likelihood ratio test: chi2=2.7933  , p=0.4246  , df=3
parameter F test:         F=0.9103  , p=0.4366  , df_denom=246, df_num=3

Granger Causality
number of lags (no zero) 4
ssr based F test:         F=0.8554  , p=0.4914  , df_denom=243, df_num=4
ssr based chi2 test:   chi2=3.5483  , p=0.4706  , df=4
likelihood ratio test: chi2=3.5235  , p=0.4743  , df=4
parameter F test:         F=0.8554  , p=0.4914  , df_denom=243, df_num=4

Granger Causality
number of lags (no zero) 5
ssr based F test:         F=1.8087  , p=0.1118  , df_denom=240, df_num=5
ssr based chi2 test:   chi2=9.4578  , p=0.0921  , df=5
likelihood ratio test: chi2=9.2840  , p=0.0983  , df=5
parameter F test:         F=1.8087  , p=0.1118  , df_denom=240, df_num=5

Granger Causality
number of lags (no zero) 6
ssr based F test:         F=2.0385  , p=0.0614  , df_denom=237, df_num=6
ssr based chi2 test:   chi2=12.9021 , p=0.0446  , df=6
likelihood ratio test: chi2=12.5802 , p=0.0502  , df=6
parameter F test:         F=2.0385  , p=0.0614  , df_denom=237, df_num=6

========================================

For: GPDI : Billions of dollars

Granger Causality
number of lags (no zero) 1
ssr based F test:         F=0.3612  , p=0.5484  , df_denom=252, df_num=1
ssr based chi2 test:   chi2=0.3655  , p=0.5454  , df=1
likelihood ratio test: chi2=0.3653  , p=0.5456  , df=1
parameter F test:         F=0.3612  , p=0.5484  , df_denom=252, df_num=1

Granger Causality
number of lags (no zero) 2
ssr based F test:         F=0.0208  , p=0.9794  , df_denom=249, df_num=2
ssr based chi2 test:   chi2=0.0425  , p=0.9790  , df=2
likelihood ratio test: chi2=0.0425  , p=0.9790  , df=2
parameter F test:         F=0.0208  , p=0.9794  , df_denom=249, df_num=2

Granger Causality
number of lags (no zero) 3
ssr based F test:         F=1.3069  , p=0.2727  , df_denom=246, df_num=3
ssr based chi2 test:   chi2=4.0323  , p=0.2580  , df=3
likelihood ratio test: chi2=4.0005  , p=0.2614  , df=3
parameter F test:         F=1.3069  , p=0.2727  , df_denom=246, df_num=3

Granger Causality
number of lags (no zero) 4
ssr based F test:         F=1.0861  , p=0.3640  , df_denom=243, df_num=4
ssr based chi2 test:   chi2=4.5051  , p=0.3419  , df=4
likelihood ratio test: chi2=4.4653  , p=0.3467  , df=4
parameter F test:         F=1.0861  , p=0.3640  , df_denom=243, df_num=4

Granger Causality
number of lags (no zero) 5
ssr based F test:         F=1.0364  , p=0.3968  , df_denom=240, df_num=5
ssr based chi2 test:   chi2=5.4197  , p=0.3668  , df=5
likelihood ratio test: chi2=5.3620  , p=0.3733  , df=5
parameter F test:         F=1.0364  , p=0.3968  , df_denom=240, df_num=5

Granger Causality
number of lags (no zero) 6
ssr based F test:         F=1.0198  , p=0.4130  , df_denom=237, df_num=6
ssr based chi2 test:   chi2=6.4546  , p=0.3742  , df=6
likelihood ratio test: chi2=6.3727  , p=0.3828  , df=6
parameter F test:         F=1.0198  , p=0.4130  , df_denom=237, df_num=6

Granger Causality
number of lags (no zero) 7
ssr based F test:         F=1.6969  , p=0.1105  , df_denom=234, df_num=7
ssr based chi2 test:   chi2=12.6395 , p=0.0814  , df=7
likelihood ratio test: chi2=12.3291 , p=0.0902  , df=7
parameter F test:         F=1.6969  , p=0.1105  , df_denom=234, df_num=7

Granger Causality
number of lags (no zero) 8
ssr based F test:         F=1.8874  , p=0.0628  , df_denom=231, df_num=8
ssr based chi2 test:   chi2=16.2107 , p=0.0395  , df=8
likelihood ratio test: chi2=15.7029 , p=0.0468  , df=8
parameter F test:         F=1.8874  , p=0.0628  , df_denom=231, df_num=8

Granger Causality
number of lags (no zero) 9
ssr based F test:         F=2.3202  , p=0.0162  , df_denom=228, df_num=9
ssr based chi2 test:   chi2=22.6221 , p=0.0071  , df=9
likelihood ratio test: chi2=21.6454 , p=0.0101  , df=9
parameter F test:         F=2.3202  , p=0.0162  , df_denom=228, df_num=9

========================================

For: NETEXP : Billions of dollars

Granger Causality
number of lags (no zero) 1
ssr based F test:         F=9.1682  , p=0.0027  , df_denom=252, df_num=1
ssr based chi2 test:   chi2=9.2773  , p=0.0023  , df=1
likelihood ratio test: chi2=9.1126  , p=0.0025  , df=1
parameter F test:         F=9.1682  , p=0.0027  , df_denom=252, df_num=1

========================================

For: GovTotExp : Billions of dollars

Granger Causality
number of lags (no zero) 1
ssr based F test:         F=57.2092 , p=0.0000  , df_denom=252, df_num=1
ssr based chi2 test:   chi2=57.8903 , p=0.0000  , df=1
likelihood ratio test: chi2=52.1702 , p=0.0000  , df=1
parameter F test:         F=57.2092 , p=0.0000  , df_denom=252, df_num=1

========================================
</pre></div>
</div>
</div>
</div>
<p>here we are just looking for a single lag for each feature which has statiscally significant p-values. Personal consumption Expenditures arguably did not make this cut off, however the sixth lag is so close that I decided to keep it in. Our next step is to create our VAR model now that we have decided that all of our features are significant.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.api</span> <span class="kn">import</span> <span class="n">VAR</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GDP : Billions of dollars&#39;</span><span class="p">,</span> <span class="s1">&#39;PCE : Billions of dollars&#39;</span><span class="p">,</span> <span class="s1">&#39;GPDI : Billions of dollars&#39;</span><span class="p">,</span> <span class="s1">&#39;NETEXP : Billions of dollars&#39;</span><span class="p">,</span> <span class="s1">&#39;GovTotExp : Billions of dollars&#39;</span><span class="p">]</span>
<span class="n">data_diff</span> <span class="o">=</span> <span class="n">data_diff</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span>

<span class="n">split_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_diff</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.90</span><span class="p">)</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">data_diff</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">split_index</span><span class="p">]</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">data_diff</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">split_index</span><span class="p">:]</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">VAR</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">maxlags</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">forecast_steps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="n">forecast</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">train_data</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="n">results</span><span class="o">.</span><span class="n">k_ar</span><span class="p">:],</span> <span class="n">steps</span><span class="o">=</span><span class="n">forecast_steps</span><span class="p">)</span>


<span class="n">forecast_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">forecast</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">test_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>


<span class="n">gdp_forecast</span> <span class="o">=</span> <span class="n">forecast_df</span><span class="p">[</span><span class="s1">&#39;GDP : Billions of dollars&#39;</span><span class="p">]</span>
<span class="n">gdp_actual</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;GDP : Billions of dollars&#39;</span><span class="p">]</span>


<span class="n">dates</span> <span class="o">=</span> <span class="n">data_diff</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">split_index</span><span class="p">:]</span>


<span class="n">comparison_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">Date_col</span><span class="p">,</span> <span class="s1">&#39;Actual GDP&#39;</span><span class="p">:</span> <span class="n">gdp_actual</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;Forecasted GDP&#39;</span><span class="p">:</span> <span class="n">gdp_forecast</span><span class="o">.</span><span class="n">values</span><span class="p">})</span>
<span class="n">comparison_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Actual GDP&#39;</span><span class="p">],</span> <span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Forecasted GDP&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE: </span><span class="si">{</span><span class="n">mae</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_true</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Actual GDP&#39;</span><span class="p">],</span> <span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Forecasted GDP&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE: </span><span class="si">{</span><span class="n">mape</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;GDP Actual vs Forecast:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">comparison_df</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Actual GDP&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual GDP&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Forecasted GDP&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forecasted GDP&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;GDP : Billions of dollars&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Actual vs Forecasted GDP using VAR&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\Dronm\anaconda3\Lib\site-packages\statsmodels\tsa\base\tsa_model.py:473: ValueWarning: An unsupported index was provided and will be ignored when e.g. forecasting.
  self._init_dates(dates, freq)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAE: 328.39
MAPE: 57.72%
GDP Actual vs Forecast:
          Date  Actual GDP  Forecasted GDP
231 2017-10-01     344.493       84.479946
232 2018-01-01     291.465      179.477634
233 2018-04-01     252.359      155.624087
234 2018-07-01     217.818      105.220413
235 2018-10-01     119.137      153.221441
236 2019-01-01     186.266      240.780124
237 2019-04-01     280.642      216.362075
238 2019-07-01     309.507      151.012279
239 2019-10-01     208.108      286.572411
240 2020-01-01    -195.877      232.309027
241 2020-04-01   -1793.370      226.008422
242 2020-07-01    1734.497      242.669525
243 2020-10-01     376.862      255.241138
244 2021-01-01     575.683      203.352525
245 2021-04-01     692.177      247.383534
246 2021-07-01     536.611      211.806723
247 2021-10-01     825.630      188.329785
248 2022-01-01     374.513      193.401142
249 2022-04-01     515.157      220.097723
250 2022-07-01     450.366      193.285245
251 2022-10-01     413.766      200.739952
252 2023-01-01     405.196      220.162682
253 2023-04-01     249.411      174.751380
254 2023-07-01     547.116      229.388535
255 2023-10-01     346.870      241.182963
256 2024-01-01     298.930      201.618804
</pre></div>
</div>
<img alt="../_images/80516886a639249bed548ee2524a287a74f5397d5506dc1f4630115e687542f5.png" src="../_images/80516886a639249bed548ee2524a287a74f5397d5506dc1f4630115e687542f5.png" />
</div>
</div>
<p>Looking this forecast, we can clealy see that despite missing the mark quite heavily on both evaluation metrics used (MAE and MAPE), our model visually was not too innaccurate barring the outliers caused by the pandemic. We managed to stay on the testing line for the most part from 2018-2019 and from 2022-2024, however the global events following obviously threw in some unpredictability which affected the model’s ability to precisely judge the trends.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="vecm-forecasting">
<h1>VECM forecasting<a class="headerlink" href="#vecm-forecasting" title="Link to this heading">#</a></h1>
<p>VECM (Vector Error Correction Model) is similar to, albeit a few key differences. Unlike VAR, VECM does not rely on stationarity so differencing and normalizing the time series will not be necessary. Below is a Johansen cointegration test which conpares test values to critical values in order to determine the number of relevant cointegration relationships (variables which share a long term equilibrium relationship).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.vector_ar.vecm</span> <span class="kn">import</span> <span class="n">VECM</span><span class="p">,</span> <span class="n">select_order</span><span class="p">,</span> <span class="n">select_coint_rank</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GDP : Billions of dollars&#39;</span><span class="p">,</span> <span class="s1">&#39;PCE : Billions of dollars&#39;</span><span class="p">,</span> <span class="s1">&#39;GPDI : Billions of dollars&#39;</span><span class="p">,</span> <span class="s1">&#39;NETEXP : Billions of dollars&#39;</span><span class="p">,</span> <span class="s1">&#39;GovTotExp : Billions of dollars&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span>
<span class="n">rank_test</span> <span class="o">=</span> <span class="n">select_coint_rank</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">det_order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">k_ar_diff</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rank_test</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Johansen cointegration test using trace test statistic with 5% significance level
=====================================
r_0 r_1 test statistic critical value
-------------------------------------
  0   5          243.6          69.82
  1   5          94.27          47.85
  2   5          47.34          29.80
  3   5          15.06          15.49
-------------------------------------
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GDP : Billions of dollars&#39;</span><span class="p">,</span> <span class="s1">&#39;PCE : Billions of dollars&#39;</span><span class="p">,</span> <span class="s1">&#39;GPDI : Billions of dollars&#39;</span><span class="p">,</span> <span class="s1">&#39;NETEXP : Billions of dollars&#39;</span><span class="p">,</span> <span class="s1">&#39;GovTotExp : Billions of dollars&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span>
<span class="n">split_index1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.90</span><span class="p">)</span>
<span class="n">train_data1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">split_index1</span><span class="p">]</span>
<span class="n">test_data1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">split_index1</span><span class="p">:]</span>
<span class="n">rank_test</span> <span class="o">=</span> <span class="n">select_coint_rank</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">det_order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">k_ar_diff</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lag_order</span> <span class="o">=</span> <span class="n">select_order</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">maxlags</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">deterministic</span><span class="o">=</span><span class="s2">&quot;ci&quot;</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">VECM</span><span class="p">(</span><span class="n">train_data1</span><span class="p">,</span> <span class="n">k_ar_diff</span><span class="o">=</span><span class="n">lag_order</span><span class="o">.</span><span class="n">aic</span><span class="p">,</span> <span class="n">coint_rank</span><span class="o">=</span><span class="n">rank_test</span><span class="o">.</span><span class="n">rank</span><span class="p">,</span> <span class="n">deterministic</span><span class="o">=</span><span class="s1">&#39;ci&#39;</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="n">forecast_steps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_data1</span><span class="p">)</span>
<span class="n">forecast</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">forecast_steps</span><span class="p">)</span>

<span class="n">forecast_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">forecast</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">test_data1</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>

<span class="n">gdp_forecast</span> <span class="o">=</span> <span class="n">forecast_df</span><span class="p">[</span><span class="s1">&#39;GDP : Billions of dollars&#39;</span><span class="p">]</span>
<span class="n">gdp_actual</span> <span class="o">=</span> <span class="n">test_data1</span><span class="p">[</span><span class="s1">&#39;GDP : Billions of dollars&#39;</span><span class="p">]</span>

<span class="n">dates</span> <span class="o">=</span> <span class="n">dates</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">gdp_actual</span><span class="p">)]</span>

<span class="n">comparison_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">Date_col</span><span class="p">,</span> <span class="s1">&#39;Actual GDP&#39;</span><span class="p">:</span> <span class="n">gdp_actual</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;Forecasted GDP&#39;</span><span class="p">:</span> <span class="n">gdp_forecast</span><span class="o">.</span><span class="n">values</span><span class="p">})</span>
<span class="n">comparison_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Actual GDP&#39;</span><span class="p">],</span> <span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Forecasted GDP&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE: </span><span class="si">{</span><span class="n">mae</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;GDP Actual vs Forecast:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">comparison_df</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Actual GDP&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual GDP&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Forecasted GDP&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forecasted GDP&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;GDP : Billions of dollars&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Actual vs Forecasted GDP using VECM&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAE: 1482.53
GDP Actual vs Forecast:
          Date  Actual GDP  Forecasted GDP
231 2017-10-01   20037.088    19753.822655
232 2018-01-01   20328.553    19886.303817
233 2018-04-01   20580.912    20019.396912
234 2018-07-01   20798.730    20091.444369
235 2018-10-01   20917.867    20201.747583
236 2019-01-01   21104.133    20397.007183
237 2019-04-01   21384.775    20590.328595
238 2019-07-01   21694.282    20715.361432
239 2019-10-01   21902.390    20933.376095
240 2020-01-01   21706.513    21102.670722
241 2020-04-01   19913.143    21333.003367
242 2020-07-01   21647.640    21572.994781
243 2020-10-01   22024.502    21812.328621
244 2021-01-01   22600.185    22030.977990
245 2021-04-01   23292.362    22299.984264
246 2021-07-01   23828.973    22534.530745
247 2021-10-01   24654.603    22750.677701
248 2022-01-01   25029.116    22985.403756
249 2022-04-01   25544.273    23271.176604
250 2022-07-01   25994.639    23483.148023
251 2022-10-01   26408.405    23719.922245
252 2023-01-01   26813.601    23977.040794
253 2023-04-01   27063.012    24160.506343
254 2023-07-01   27610.128    24361.691614
255 2023-10-01   27956.998    24615.083068
256 2024-01-01   28255.928    24786.868614
</pre></div>
</div>
<img alt="../_images/783e20d430ecb6dfd85b84c778d3b0fbb6fd4555a015c47562a2ced9cd7d2b96.png" src="../_images/783e20d430ecb6dfd85b84c778d3b0fbb6fd4555a015c47562a2ced9cd7d2b96.png" />
</div>
</div>
<p>Though it is hard to compare to our VAR model to this one given that we are now using the unstationary data, we can still deduce both by the error metric and the visualization that this model was not able to accurately capture the trends in this forecast. With this, it is fair to say that we can rule out traditional statistical methods for approaching this problem.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="machine-learning-forecasting">
<h1>Machine Learning forecasting<a class="headerlink" href="#machine-learning-forecasting" title="Link to this heading">#</a></h1>
<p>When deciding a machine learning approach to model this problem, I wanted to keep in mind the amount of data that I am working with. Prior to creating lagged columns, out dataset has a total of 1275 observations across all time series. This means that using more complex approaches, such as LSTMs or gradient boosting, are perhaps unnecessary as we can use more simple model to recieve the same amount of accuracy and far more interpretability.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">printevals</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">y_pred</span><span class="p">):</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE: </span><span class="si">{</span><span class="n">mape</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE: </span><span class="si">{</span><span class="n">mae</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">plotresults</span><span class="p">(</span><span class="n">title</span><span class="p">):</span>
    
    <span class="n">comparison_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">Date_col</span><span class="p">,</span> <span class="s1">&#39;Actual GDP&#39;</span><span class="p">:</span> <span class="n">y_test</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;Forecasted GDP&#39;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">})</span>
    <span class="n">comparison_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;GDP Actual vs Forecast:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">comparison_df</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Actual GDP&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual GDP&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Forecasted GDP&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forecasted GDP&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;GDP : Billions of dollars&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="train-test-split">
<h1>Train-Test Split<a class="headerlink" href="#train-test-split" title="Link to this heading">#</a></h1>
<p>Train-test splits for time series problems differ slightly from splits in traditional regression or classification tasks. Here it is imparative that we do not shuffle around our data, since that would mean we are training our model on data from the future which in turn will cause data leakages. Also notice that we are training over a very large portion (90%) of the data. This is because we are not actually concerned with forecasting over a large time frame. Realistically even forecasting over several years is not probable for this task. (Note we also used the train test split in our VAR and VECM models, it just felt more appropriate to talk about in the Machine Learning section)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">split_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_diff</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.90</span><span class="p">)</span>

<span class="n">train_data</span> <span class="o">=</span> <span class="n">data_diff</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">split_index</span><span class="p">]</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">data_diff</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">split_index</span><span class="p">:]</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;GDP : Billions of dollars&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;GDP : Billions of dollars&#39;</span><span class="p">]</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;GDP : Billions of dollars&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;GDP : Billions of dollars&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="random-forests">
<h1>Random Forests<a class="headerlink" href="#random-forests" title="Link to this heading">#</a></h1>
<p>Remembering our VIF test from earlier, we know our features are highly multicolinear. This partially plays into the decision of choosing random forests as our model. decision trees make binary choices between features, meaning that theoretically our features being highly correlated should not be detrimental to our model. In addition to this, random forests is generally a very strong model being robust to overfitting from the schocastic nature of how the trees are computed and generally being very simple to implement.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>

<span class="n">rf_model</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">rf_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">rf_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">printevals</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">y_pred</span><span class="p">)</span>
<span class="n">plotresults</span><span class="p">(</span><span class="s1">&#39;Actual vs Forecasted GDP using Random Forest&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAPE: 44.31%
MAE: 287.97
GDP Actual vs Forecast:
          Date  Actual GDP  Forecasted GDP
231 2017-10-01     344.493       222.66964
232 2018-01-01     291.465       232.99618
233 2018-04-01     252.359       192.05078
234 2018-07-01     217.818       220.23716
235 2018-10-01     119.137       118.40956
236 2019-01-01     186.266       115.82722
237 2019-04-01     280.642       198.88359
238 2019-07-01     309.507       228.12818
239 2019-10-01     208.108       156.30033
240 2020-01-01    -195.877       -78.69897
241 2020-04-01   -1793.370      -161.98572
242 2020-07-01    1734.497       233.81564
243 2020-10-01     376.862       233.81564
244 2021-01-01     575.683       151.72623
245 2021-04-01     692.177       129.98664
246 2021-07-01     536.611       233.97176
247 2021-10-01     825.630       235.97884
248 2022-01-01     374.513       233.81564
249 2022-04-01     515.157       163.32067
250 2022-07-01     450.366       167.84568
251 2022-10-01     413.766       275.92276
252 2023-01-01     405.196       157.41253
253 2023-04-01     249.411       240.37866
254 2023-07-01     547.116       296.78346
255 2023-10-01     346.870       198.98305
256 2024-01-01     298.930       179.61721
</pre></div>
</div>
<img alt="../_images/9ae56db5376b0e28be6aa9860df8e3bb52ace279c15095164fd84549f91c6c2b.png" src="../_images/9ae56db5376b0e28be6aa9860df8e3bb52ace279c15095164fd84549f91c6c2b.png" />
</div>
</div>
<p>We can see that Random Forests was able to produce our best forecast yet, attaining better error metrics than our attepts at VAR and VECM. Perhaps most impressively, visually we can see that our model was almost perfectly encaptualiting the data from 2017-2019, just prior to encountering the outliers.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="knn">
<h1>KNN<a class="headerlink" href="#knn" title="Link to this heading">#</a></h1>
<p>KNN (K-Nearest-Neighbors) was one final apporach I wanted to attempt. Given that our data is fairly low dimensional (5 features), with over 1000 observations, we have a ratio which should allow this algorithm to perform very well. Notice below we test out various values of our hyperparamter k, with k=2 seemingly being the best one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">knn_model</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="n">knn_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">knn_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;for k = </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> &#39;</span><span class="p">)</span>
    <span class="n">printevals</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">y_pred</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">40</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>for k = 1 
MAPE: 48.93%
MAE: 302.74

========================================

for k = 2 
MAPE: 47.72%
MAE: 303.45

========================================

for k = 3 
MAPE: 48.31%
MAE: 306.37

========================================

for k = 4 
MAPE: 48.41%
MAE: 306.15

========================================

for k = 5 
MAPE: 49.35%
MAE: 310.94

========================================

for k = 6 
MAPE: 50.54%
MAE: 315.49

========================================

for k = 7 
MAPE: 50.36%
MAE: 315.71

========================================

for k = 8 
MAPE: 50.62%
MAE: 317.13

========================================

for k = 9 
MAPE: 50.04%
MAE: 315.95

========================================
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">knn_model</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">knn_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">knn_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">printevals</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">y_pred</span><span class="p">)</span>

<span class="n">plotresults</span><span class="p">(</span><span class="s1">&#39;Actual vs Forecasted GDP using KNN&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAPE: 47.72%
MAE: 303.45
GDP Actual vs Forecast:
          Date  Actual GDP  Forecasted GDP
231 2017-10-01     344.493        237.9050
232 2018-01-01     291.465        252.8530
233 2018-04-01     252.359        217.4445
234 2018-07-01     217.818        206.1615
235 2018-10-01     119.137        115.1375
236 2019-01-01     186.266        110.2265
237 2019-04-01     280.642        203.0175
238 2019-07-01     309.507        264.4540
239 2019-10-01     208.108        156.4880
240 2020-01-01    -195.877          1.0515
241 2020-04-01   -1793.370        -65.8135
242 2020-07-01    1734.497        227.1580
243 2020-10-01     376.862        129.9220
244 2021-01-01     575.683        167.6270
245 2021-04-01     692.177        124.7765
246 2021-07-01     536.611        227.1580
247 2021-10-01     825.630        227.1580
248 2022-01-01     374.513        193.9800
249 2022-04-01     515.157        167.6270
250 2022-07-01     450.366        185.8210
251 2022-10-01     413.766        167.6270
252 2023-01-01     405.196        183.3980
253 2023-04-01     249.411        264.4540
254 2023-07-01     547.116        167.6270
255 2023-10-01     346.870        221.4005
256 2024-01-01     298.930        198.0385
</pre></div>
</div>
<img alt="../_images/f7c382591e365ff998ed8ae0af0599e36e946b271b6810f6c75eacea484ea150.png" src="../_images/f7c382591e365ff998ed8ae0af0599e36e946b271b6810f6c75eacea484ea150.png" />
</div>
</div>
<p>We can see KNN in its own right performed very well. Despite being out performed slightly in terms of error metrics compared to Random Forests, visually the model performed about the same and arguably captured the period before the pandemic from 2018-2019 even better than Random Forests.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="conclusions">
<h1>Conclusions<a class="headerlink" href="#conclusions" title="Link to this heading">#</a></h1>
<p>Looking at all of our models, we can see the one which performed the best was Random Forests. This is most likely due to Random Forests generally being a very strong predictive model which can be fit to a vairety of datasets. In general the machine learning algorithms far outperformed the traditional statistical methods. Perhaps this can be explained by the fact that VAR and VECM both require a great amount of historical background data to work optimally, something which we did not have much of given that our data came out in quarterly intervals. There also may be something to be said about how both the machine learning models used were nonparametric. These models often are governed by less assumptions than their counterparts and therefore may be more flexible to unique problem sets like the one here. Below is our final best prediction, removing the differencing transformation we previously used to fit the models.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rf_model</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">rf_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">rf_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">comparison_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">Date_col</span><span class="p">,</span> <span class="s1">&#39;Actual GDP&#39;</span><span class="p">:</span> <span class="n">y_test</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;Forecasted GDP&#39;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">})</span>
<span class="n">comparison_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">last_actual_value</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">split_index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;GDP : Billions of dollars&#39;</span><span class="p">]</span>

<span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Actual GDP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Actual GDP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span> <span class="o">+</span> <span class="n">last_actual_value</span>
<span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Forecasted GDP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Forecasted GDP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span> <span class="o">+</span> <span class="n">last_actual_value</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Actual GDP&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual GDP&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;Forecasted GDP&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forecasted GDP&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;GDP : Billions of dollars&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Actual vs Forecasted GDP (Differencing Removed) using Random Forest&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/626696a6c0284111d5c3c3a3104047b1cc81b1f8f3387a6a6614619bbfd0b2c8.png" src="../_images/626696a6c0284111d5c3c3a3104047b1cc81b1f8f3387a6a6614619bbfd0b2c8.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="challenges-and-areas-of-improvement">
<h1>Challenges and Areas of Improvement<a class="headerlink" href="#challenges-and-areas-of-improvement" title="Link to this heading">#</a></h1>
<p>By far the greatest challenge regarding this forecasting problem was handeling the massive outlier caused by the pandemic along with the following instability caused by it. Our methods for forecasting obviously can not predict that this would occur, ultimately decreasing our accuracy for each approach. Had our goal been to forecast the previous decade, our models would most likely have a much easier time finding and predicting trends. In terms of improvement and further research, I think a possible solution would be to perform some sort of normalization and outlier smoothing technique on the time interval from 2020-2024, and then evaluating our fully trained model on new quarterly data which comes in. In addition, it may be beneficial to incorporate new features which have a heavy influence on GDP such as quarterly inflation and personal assest evaluations.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="references">
<h1>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h1>
<p>For traditional statistical methods - <a class="reference external" href="https://link.springer.com/book/10.1007/978-1-4842-7150-6">https://link.springer.com/book/10.1007/978-1-4842-7150-6</a>
For machine learning methods - <a class="reference external" href="https://www.statlearning.com/">https://www.statlearning.com/</a></p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./final_project_demo"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="milleradamchristopher.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Classifying Songs by Genre using its Features</p>
      </div>
    </a>
    <a class="right-next"
       href="nguyenalexanderdavid.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">MOVIE SUCCESS IN RELATION TO ITS FILM DISTRIBUTION COMPANY</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">US GDP Forecasting</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation-and-procedure">Motivation and Procedure</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-creation">Feature Creation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#eda">EDA</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling">Modeling</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#var-forecasting">VAR forecasting</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#vecm-forecasting">VECM forecasting</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#machine-learning-forecasting">Machine Learning forecasting</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#train-test-split">Train-Test Split</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forests">Random Forests</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#knn">KNN</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">Conclusions</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#challenges-and-areas-of-improvement">Challenges and Areas of Improvement</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ray Zirui Zhang
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>